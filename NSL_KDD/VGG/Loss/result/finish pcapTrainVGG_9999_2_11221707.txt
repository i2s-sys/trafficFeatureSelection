2024-11-22 17:10:19.048173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainVGG_9999_2.py
2024-11-22 17:10:21.129471: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-22 17:10:21.137891: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-22 17:10:21.139035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-22 17:10:21.167035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-22 17:10:21.167089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-22 17:10:21.170830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-22 17:10:21.170897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-22 17:10:21.172172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-22 17:10:21.172492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-22 17:10:21.175535: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-22 17:10:21.176253: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-22 17:10:21.176421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-22 17:10:21.176795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-22 17:10:21.176827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-22 17:10:21.767366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-22 17:10:21.767418: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-22 17:10:21.767428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-22 17:10:21.768177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22422 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
BETA = 0.9999, GAMMA = 2
init data completed!
2024-11-22 17:10:29.645600: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-22 17:10:29.646002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-22 17:10:29.646038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-22 17:10:29.646074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-22 17:10:29.646087: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-22 17:10:29.646100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-22 17:10:29.646123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-22 17:10:29.646136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-22 17:10:29.646148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-22 17:10:29.646160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-22 17:10:29.646459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-22 17:10:29.690875: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-22 17:10:29.691189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-22 17:10:29.691217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-22 17:10:29.691246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-22 17:10:29.691259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-22 17:10:29.691271: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-22 17:10:29.691282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-22 17:10:29.691294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-22 17:10:29.691306: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-22 17:10:29.691318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-22 17:10:29.691596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-22 17:10:29.691630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-22 17:10:29.691638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-22 17:10:29.691645: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-22 17:10:29.691949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22422 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
2024-11-22 17:10:30.035958: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-22 17:10:30.051647: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-22 17:10:30.762942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-22 17:10:31.447568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-22 17:10:31.451863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-22 17:10:33.511752: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-22 17:10:33.651604: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-22 17:11:02.452910: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 3.3464669753320333, duration: 86.49 seconds
Macro-F1: 0.7846900824503182
Micro-F1: 0.7853530872959547
Epoch 2 completed, average loss: 1.2544634247698434, duration: 13.79 seconds
Macro-F1: 0.7794060840898667
Micro-F1: 0.7802519517388219
Epoch 3 completed, average loss: 0.9254388870686535, duration: 14.01 seconds
Macro-F1: 0.7634592272238578
Micro-F1: 0.7649041873669269
Epoch 4 completed, average loss: 0.7353517786501264, duration: 15.29 seconds
Macro-F1: 0.7680764156366409
Micro-F1: 0.7693399574166075
Epoch 5 completed, average loss: 0.6212617201471278, duration: 15.21 seconds
Macro-F1: 0.7703755692896288
Micro-F1: 0.771513484740951
Epoch 6 completed, average loss: 0.5707130428503941, duration: 15.16 seconds
Macro-F1: 0.7654553774323772
Micro-F1: 0.7667672107877929
Epoch 7 completed, average loss: 0.5386226824323866, duration: 15.17 seconds
Macro-F1: 0.7642209251781771
Micro-F1: 0.7655695528743791
Epoch 8 completed, average loss: 0.5189326776544624, duration: 14.99 seconds
Macro-F1: 0.7601159109677265
Micro-F1: 0.7617104329311569
Epoch 9 completed, average loss: 0.4751469947007765, duration: 15.16 seconds
Macro-F1: 0.7833224644532044
Micro-F1: 0.7839779985805536
Epoch 10 completed, average loss: 0.455105785128085, duration: 17.12 seconds
Macro-F1: 0.7843126525124295
Micro-F1: 0.7849982256919801
Epoch 11 completed, average loss: 0.4147261636060988, duration: 16.91 seconds
Macro-F1: 0.7908023030110434
Micro-F1: 0.7912526614620298
Epoch 12 completed, average loss: 0.4049902103961506, duration: 16.87 seconds
Macro-F1: 0.7674595027276964
Micro-F1: 0.7685858765081618
Epoch 13 completed, average loss: 0.3825191061026171, duration: 16.81 seconds
Macro-F1: 0.7785941953718414
Micro-F1: 0.7793647977288858
Epoch 14 completed, average loss: 0.35950584931697077, duration: 16.92 seconds
Macro-F1: 0.7722091701734546
Micro-F1: 0.7727998580553584
Epoch 15 completed, average loss: 0.3453746664328822, duration: 17.28 seconds
Macro-F1: 0.7649942826894773
Micro-F1: 0.7662349183818311
Epoch 16 completed, average loss: 0.32582085382153575, duration: 17.37 seconds
Macro-F1: 0.7752082549421502
Micro-F1: 0.7761266855926189
Epoch 17 completed, average loss: 0.3222673223551497, duration: 17.26 seconds
Macro-F1: 0.7530038478333796
Micro-F1: 0.7536816891412349
Epoch 18 completed, average loss: 0.3120568415340937, duration: 16.94 seconds
Macro-F1: 0.7588007691586155
Micro-F1: 0.7603797019162526
Epoch 19 completed, average loss: 0.29720918087530557, duration: 17.01 seconds
Macro-F1: 0.7720405904670515
Micro-F1: 0.7730660042583393
Epoch 20 completed, average loss: 0.28747727252825495, duration: 17.10 seconds
Macro-F1: 0.7756459710453704
Micro-F1: 0.776570262597587
Epoch 21 completed, average loss: 0.2717225731373433, duration: 17.16 seconds
Macro-F1: 0.7727130338535837
Micro-F1: 0.7737313697657913
Epoch 22 completed, average loss: 0.27200587669293286, duration: 17.11 seconds
Macro-F1: 0.7807731148086646
Micro-F1: 0.7816270404542228
Epoch 23 completed, average loss: 0.26711928440787097, duration: 16.90 seconds
Macro-F1: 0.7714279712726322
Micro-F1: 0.7725337118523776
Epoch 24 completed, average loss: 0.24125071963736422, duration: 16.94 seconds
Macro-F1: 0.7818728398617512
Micro-F1: 0.7825585521646556
Epoch 25 completed, average loss: 0.22765134060901113, duration: 16.94 seconds
Macro-F1: 0.7665938129374662
Micro-F1: 0.767876153300213
Epoch 26 completed, average loss: 0.2368037305335307, duration: 16.91 seconds
Macro-F1: 0.7530353905359626
Micro-F1: 0.7548793470546488
Epoch 27 completed, average loss: 0.22514813471810904, duration: 17.05 seconds
Macro-F1: 0.7949928962635626
Micro-F1: 0.7953779276082328
Epoch 28 completed, average loss: 0.22774010105928116, duration: 17.02 seconds
Macro-F1: 0.7987243944717306
Micro-F1: 0.7990152590489709
Epoch 29 completed, average loss: 0.21715946789118343, duration: 17.08 seconds
Macro-F1: 0.7689688500031404
Micro-F1: 0.77013839602555
Epoch 30 completed, average loss: 0.19977438756873328, duration: 17.02 seconds
Macro-F1: 0.8073693279792956
Micro-F1: 0.8075319375443577
loss_history [3.3464669753320333, 1.2544634247698434, 0.9254388870686535, 0.7353517786501264, 0.6212617201471278, 0.5707130428503941, 0.5386226824323866, 0.5189326776544624, 0.4751469947007765, 0.455105785128085, 0.4147261636060988, 0.4049902103961506, 0.3825191061026171, 0.35950584931697077, 0.3453746664328822, 0.32582085382153575, 0.3222673223551497, 0.3120568415340937, 0.29720918087530557, 0.28747727252825495, 0.2717225731373433, 0.27200587669293286, 0.26711928440787097, 0.24125071963736422, 0.22765134060901113, 0.2368037305335307, 0.22514813471810904, 0.22774010105928116, 0.21715946789118343, 0.19977438756873328]
macro_F1List [0.7853530872959547, 0.7802519517388219, 0.7649041873669269, 0.7693399574166075, 0.771513484740951, 0.7667672107877929, 0.7655695528743791, 0.7617104329311569, 0.7839779985805536, 0.7849982256919801, 0.7912526614620298, 0.7685858765081618, 0.7793647977288858, 0.7727998580553584, 0.7662349183818311, 0.7761266855926189, 0.7536816891412349, 0.7603797019162526, 0.7730660042583393, 0.776570262597587, 0.7737313697657913, 0.7816270404542228, 0.7725337118523776, 0.7825585521646556, 0.767876153300213, 0.7548793470546488, 0.7953779276082328, 0.7990152590489709, 0.77013839602555, 0.8075319375443577]
micro_F1List [0.7846900824503182, 0.7794060840898667, 0.7634592272238578, 0.7680764156366409, 0.7703755692896288, 0.7654553774323772, 0.7642209251781771, 0.7601159109677265, 0.7833224644532044, 0.7843126525124295, 0.7908023030110434, 0.7674595027276964, 0.7785941953718414, 0.7722091701734546, 0.7649942826894773, 0.7752082549421502, 0.7530038478333796, 0.7588007691586155, 0.7720405904670515, 0.7756459710453704, 0.7727130338535837, 0.7807731148086646, 0.7714279712726322, 0.7818728398617512, 0.7665938129374662, 0.7530353905359626, 0.7949928962635626, 0.7987243944717306, 0.7689688500031404, 0.8073693279792956]
start testing...
Processed 10000 rows
Processed 20000 rows
0 0.9710637421480794 9430 9711
1 0.6837839943894647 8775 12833
Top-1 accuracy: 0.8075319375443577
Top-3 accuracy: 1.0
Top-5 accuracy: 1.0
Macro-F1: 0.8073693279792956
Micro-F1: 0.8075319375443577
