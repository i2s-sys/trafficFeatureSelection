2024-11-11 03:04:05.783541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainResPure_999_1.py
2024-11-11 03:04:08.383477: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-11 03:04:08.396955: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-11 03:04:08.398164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-11 03:04:08.415373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.59GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-11 03:04:08.415413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-11 03:04:08.449023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-11 03:04:08.449125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-11 03:04:08.451017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-11 03:04:08.451518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-11 03:04:08.456699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-11 03:04:08.457882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-11 03:04:08.458234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-11 03:04:08.462073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-11 03:04:08.462124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-11 03:04:09.335390: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-11 03:04:09.335462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-11 03:04:09.335473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-11 03:04:09.341244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21857 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
BETA = 0.999, GAMMA = 1
init data completed!
2024-11-11 03:04:21.794504: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-11 03:04:21.796095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.59GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-11 03:04:21.796128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-11 03:04:21.796186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-11 03:04:21.796198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-11 03:04:21.796208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-11 03:04:21.796227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-11 03:04:21.796237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-11 03:04:21.796246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-11 03:04:21.796255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-11 03:04:21.798749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-11 03:04:22.566741: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-11 03:04:22.568197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.59GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-11 03:04:22.568224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-11 03:04:22.568251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-11 03:04:22.568259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-11 03:04:22.568266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-11 03:04:22.568273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-11 03:04:22.568280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-11 03:04:22.568288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-11 03:04:22.568295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-11 03:04:22.570408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-11 03:04:22.570438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-11 03:04:22.570442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-11 03:04:22.570446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-11 03:04:22.572601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21857 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
2024-11-11 03:04:23.778147: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-11 03:04:23.878677: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-11 03:04:26.389817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-11 03:04:26.948321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-11 03:04:26.971178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-11 03:04:29.687314: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-11 03:04:29.839758: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-11 03:05:20.006994: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 10.46050561057816, duration: 303.06 seconds
Macro-F1: 0.8714673259329562
Micro-F1: 0.8732813486858085
Epoch 2 completed, average loss: 8.020124003171398, duration: 126.99 seconds
Macro-F1: 0.8596900901567818
Micro-F1: 0.8657144245250934
Epoch 3 completed, average loss: 7.752568858657291, duration: 153.01 seconds
Macro-F1: 0.8600715595942452
Micro-F1: 0.8661395326240101
Epoch 4 completed, average loss: 7.578569845181473, duration: 150.09 seconds
Macro-F1: 0.8565489914880512
Micro-F1: 0.863054462420444
Epoch 5 completed, average loss: 7.414230148316823, duration: 123.61 seconds
Macro-F1: 0.8511658454213263
Micro-F1: 0.8584875868435117
Epoch 6 completed, average loss: 7.2730053752943755, duration: 136.58 seconds
Macro-F1: 0.8529950788242431
Micro-F1: 0.8602244570762279
Epoch 7 completed, average loss: 7.161016873672463, duration: 130.50 seconds
Macro-F1: 0.8672827680520352
Micro-F1: 0.8729291162609921
Epoch 8 completed, average loss: 7.079520691825666, duration: 125.03 seconds
Macro-F1: 0.8703786239670603
Micro-F1: 0.8755890783656416
Epoch 9 completed, average loss: 7.00447346373489, duration: 140.68 seconds
Macro-F1: 0.8750749002841677
Micro-F1: 0.8798158674634406
Epoch 10 completed, average loss: 6.9280000888491475, duration: 135.49 seconds
Macro-F1: 0.8752140931628021
Micro-F1: 0.880010202594374
Epoch 11 completed, average loss: 6.860828541420601, duration: 126.27 seconds
Macro-F1: 0.8686978317149603
Micro-F1: 0.8741194189379585
Epoch 12 completed, average loss: 6.794613810853422, duration: 126.35 seconds
Macro-F1: 0.875870187997108
Micro-F1: 0.8805446242044406
Epoch 13 completed, average loss: 6.702126557414248, duration: 125.93 seconds
Macro-F1: 0.8654006925962345
Micro-F1: 0.8709371811689258
Epoch 14 completed, average loss: 6.6248329368449195, duration: 132.81 seconds
Macro-F1: 0.8642252087600112
Micro-F1: 0.8693946460671428
Epoch 15 completed, average loss: 6.546536766585858, duration: 119.97 seconds
Macro-F1: 0.8274666211052109
Micro-F1: 0.8370499927124326
Epoch 16 completed, average loss: 6.468957643077006, duration: 129.83 seconds
Macro-F1: 0.8257994977690173
Micro-F1: 0.835118787348783
Epoch 17 completed, average loss: 6.383089224642607, duration: 119.97 seconds
Macro-F1: 0.8427388489077252
Micro-F1: 0.8494388573094301
Epoch 18 completed, average loss: 6.313191156390812, duration: 129.62 seconds
Macro-F1: 0.8300897248875834
Micro-F1: 0.8385317980857988
Epoch 19 completed, average loss: 6.22246832626418, duration: 121.53 seconds
Macro-F1: 0.8695712344232942
Micro-F1: 0.8739858135354419
Epoch 20 completed, average loss: 6.108989828602949, duration: 137.67 seconds
Macro-F1: 0.819369867068102
Micro-F1: 0.8302118252927173
loss_history [10.46050561057816, 8.020124003171398, 7.752568858657291, 7.578569845181473, 7.414230148316823, 7.2730053752943755, 7.161016873672463, 7.079520691825666, 7.00447346373489, 6.9280000888491475, 6.860828541420601, 6.794613810853422, 6.702126557414248, 6.6248329368449195, 6.546536766585858, 6.468957643077006, 6.383089224642607, 6.313191156390812, 6.22246832626418, 6.108989828602949]
macro_F1List [0.8732813486858085, 0.8657144245250934, 0.8661395326240101, 0.863054462420444, 0.8584875868435117, 0.8602244570762279, 0.8729291162609921, 0.8755890783656416, 0.8798158674634406, 0.880010202594374, 0.8741194189379585, 0.8805446242044406, 0.8709371811689258, 0.8693946460671428, 0.8370499927124326, 0.835118787348783, 0.8494388573094301, 0.8385317980857988, 0.8739858135354419, 0.8302118252927173]
micro_F1List [0.8714673259329562, 0.8596900901567818, 0.8600715595942452, 0.8565489914880512, 0.8511658454213263, 0.8529950788242431, 0.8672827680520352, 0.8703786239670603, 0.8750749002841677, 0.8752140931628021, 0.8686978317149603, 0.875870187997108, 0.8654006925962345, 0.8642252087600112, 0.8274666211052109, 0.8257994977690173, 0.8427388489077252, 0.8300897248875834, 0.8695712344232942, 0.819369867068102]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
0 0.6511081081081082 24091 37000
1 0.9763963645989588 44262 45332
Top-1 accuracy: 0.8302118252927173
Top-3 accuracy: 1.0
Top-5 accuracy: 1.0
Macro-F1: 0.819369867068102
Micro-F1: 0.8302118252927173
