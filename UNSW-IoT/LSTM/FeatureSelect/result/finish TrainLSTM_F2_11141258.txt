2024-11-14 12:58:30.003590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: TrainLSTM_F2.py
2024-11-14 12:58:31.472157: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-14 12:58:31.480141: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-14 12:58:31.481065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-14 12:58:31.487075: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-14 12:58:31.487107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-14 12:58:31.489831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-14 12:58:31.489885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-14 12:58:31.491069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-14 12:58:31.491371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-14 12:58:31.494186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-14 12:58:31.494810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-14 12:58:31.495022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-14 12:58:31.495415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-14 12:58:31.495446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-14 12:58:32.070428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-14 12:58:32.070481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-14 12:58:32.070490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-14 12:58:32.071691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21759 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
BETA = 0.999, GAMMA = 2
init data completed!
2024-11-14 12:59:15.891029: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-14 12:59:15.892118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-14 12:59:15.892168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-14 12:59:15.892273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-14 12:59:15.892302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-14 12:59:15.892334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-14 12:59:15.892378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-14 12:59:15.892405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-14 12:59:15.892435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-14 12:59:15.892457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-14 12:59:15.892821: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-14 12:59:15.893115: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-14 12:59:15.893377: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-14 12:59:15.893403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-14 12:59:15.893434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-14 12:59:15.893449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-14 12:59:15.893463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-14 12:59:15.893478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-14 12:59:15.893492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-14 12:59:15.893507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-14 12:59:15.893522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-14 12:59:15.893805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-14 12:59:15.893904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-14 12:59:15.893915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-14 12:59:15.893922: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-14 12:59:15.894388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21759 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
WARNING:tensorflow:Layer lstm will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
2024-11-14 12:59:16.053755: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-14 12:59:16.054087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-14 12:59:16.054117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-14 12:59:16.054153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-14 12:59:16.054169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-14 12:59:16.054197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-14 12:59:16.054212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-14 12:59:16.054227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-14 12:59:16.054242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-14 12:59:16.054257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-14 12:59:16.054556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-14 12:59:16.054587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-14 12:59:16.054597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-14 12:59:16.054604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-14 12:59:16.054928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21759 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
2024-11-14 12:59:16.291923: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-14 12:59:16.313148: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-14 12:59:16.537218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-14 12:59:17.202248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-14 12:59:17.209162: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Macro-F1: 0.24411278967889705
Micro-F1: 0.813113652674495
Epoch 1 completed, average loss: 15.66061407799595, duration: 1896.46 seconds
Macro-F1: 0.3296597543309427
Micro-F1: 0.8431950403884622
Epoch 2 completed, average loss: 8.868377488579368, duration: 2001.29 seconds
Macro-F1: 0.4098397284015146
Micro-F1: 0.8610988104872574
Epoch 3 completed, average loss: 7.40241601230412, duration: 1969.25 seconds
Macro-F1: 0.4860456547848469
Micro-F1: 0.872978668173281
Epoch 4 completed, average loss: 6.609748503629463, duration: 1982.42 seconds
Epoch 4, Intersection size: 1
Macro-F1: 0.5408205463940589
Micro-F1: 0.8881109804700026
Epoch 5 completed, average loss: 5.387466282538904, duration: 2005.19 seconds
Epoch 5, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.5674835901656677
Micro-F1: 0.8937149750339751
Epoch 6 completed, average loss: 4.726434169726538, duration: 1956.94 seconds
Epoch 6, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.5876054413865655
Micro-F1: 0.8993571439478386
Epoch 7 completed, average loss: 4.324273741964421, duration: 1908.74 seconds
Epoch 7, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.611730013917239
Micro-F1: 0.9035257829559162
Epoch 8 completed, average loss: 4.021922122473291, duration: 1936.75 seconds
Epoch 8, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.63060948695764
Micro-F1: 0.9070301882758937
Epoch 9 completed, average loss: 3.724572070383057, duration: 1834.07 seconds
Epoch 9, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.6467884348589237
Micro-F1: 0.9087403991510025
Epoch 10 completed, average loss: 3.4383380801846504, duration: 2023.91 seconds
Epoch 10, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.667539444844462
Micro-F1: 0.9124509459603903
Epoch 11 completed, average loss: 3.181463040664299, duration: 1810.05 seconds
Epoch 11, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.6807376134757985
Micro-F1: 0.9163141901693415
Epoch 12 completed, average loss: 2.953790927912133, duration: 1974.61 seconds
Epoch 12, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.6843678647611802
Micro-F1: 0.9158942723205424
Epoch 13 completed, average loss: 2.7909493397407865, duration: 1949.29 seconds
Epoch 13, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.691549548594859
Micro-F1: 0.9196506283497992
Epoch 14 completed, average loss: 2.651984796396199, duration: 1874.48 seconds
Epoch 14, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.6962892737713938
Micro-F1: 0.9226205927713051
Epoch 15 completed, average loss: 2.5409427848779162, duration: 1877.75 seconds
Epoch 15, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.6960193291907525
Micro-F1: 0.9246209287055841
Epoch 16 completed, average loss: 2.407799419819385, duration: 1978.25 seconds
Epoch 16, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.7049195031204287
Micro-F1: 0.9298050054207577
Epoch 17 completed, average loss: 2.330869346145411, duration: 1937.67 seconds
Epoch 17, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.7236804830647214
Micro-F1: 0.929911893600452
Epoch 18 completed, average loss: 2.27830459874796, duration: 1812.26 seconds
Epoch 18, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.7221283037265177
Micro-F1: 0.934141611568355
Epoch 19 completed, average loss: 2.1969752255897417, duration: 1767.09 seconds
Epoch 19, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.7268775657666497
Micro-F1: 0.9349890821359312
Epoch 20 completed, average loss: 2.090545031432083, duration: 1837.82 seconds
Epoch 20, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.7417621443230791
Micro-F1: 0.9350043518758876
Epoch 21 completed, average loss: 2.0517296357088926, duration: 1969.30 seconds
Epoch 21, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.7295264840257718
Micro-F1: 0.934698957076761
Epoch 22 completed, average loss: 1.958268112675835, duration: 2051.35 seconds
Epoch 22, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.7329966320959929
Micro-F1: 0.935584601994228
Epoch 23 completed, average loss: 1.894126773205171, duration: 1969.54 seconds
Epoch 23, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.7557975247543393
Micro-F1: 0.9394173067232665
Epoch 24 completed, average loss: 1.9856092598730917, duration: 1841.71 seconds
Epoch 24, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.7549662607052047
Micro-F1: 0.9361648521125685
Epoch 25 completed, average loss: 1.855508915852142, duration: 1842.60 seconds
Epoch 25, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.7566046837002824
Micro-F1: 0.9426163172441173
Epoch 26 completed, average loss: 1.7460809123531065, duration: 1794.46 seconds
Epoch 26, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.7543535873130975
Micro-F1: 0.940043366061476
Epoch 27 completed, average loss: 1.749807341444877, duration: 2009.84 seconds
Epoch 27, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.7564245753973325
Micro-F1: 0.9378750629876773
Epoch 28 completed, average loss: 1.667869771905259, duration: 1907.64 seconds
Epoch 28, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.7636819300621572
Micro-F1: 0.9443036235092916
Epoch 29 completed, average loss: 1.6474191133677336, duration: 1960.81 seconds
Epoch 29, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
Macro-F1: 0.7692337183191561
Micro-F1: 0.9487013086167143
Epoch 30 completed, average loss: 1.6271099515000196, duration: 1994.06 seconds
Epoch 30, Intersection size: 2
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 2 top_k_indices [55 54]
TSMRecord—100 [1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]
loss_history—100 [15.66061407799595, 8.868377488579368, 7.40241601230412, 6.609748503629463, 5.387466282538904, 4.726434169726538, 4.324273741964421, 4.021922122473291, 3.724572070383057, 3.4383380801846504, 3.181463040664299, 2.953790927912133, 2.7909493397407865, 2.651984796396199, 2.5409427848779162, 2.407799419819385, 2.330869346145411, 2.27830459874796, 2.1969752255897417, 2.090545031432083, 2.0517296357088926, 1.958268112675835, 1.894126773205171, 1.9856092598730917, 1.855508915852142, 1.7460809123531065, 1.749807341444877, 1.667869771905259, 1.6474191133677336, 1.6271099515000196]
Total training time: 57677.05 seconds
scaling_factor_value： [[1.1178808e+00 2.0400990e-05 8.8248199e-01 9.7903627e-01 1.1899880e+00
  2.6142821e-01 9.3856108e-01 1.0306834e+00 9.1140085e-01 8.9554125e-01
  1.5696748e-01 5.9378505e-01 8.8950139e-01 1.3635243e+00 1.3283232e+00
  1.2312610e+00 1.2227119e+00 1.0355190e+00 1.0896149e+00 1.1626823e+00
  1.2618207e+00 8.0380261e-01 7.0781535e-01 6.5345371e-01 8.0868882e-01
  8.1390333e-01 1.4097533e+00 1.2602644e+00 8.7428504e-01 8.7994927e-01
  8.6552256e-01 1.2525961e+00 8.5518748e-01 7.7618760e-01 8.0971825e-01
  1.2244554e+00 1.2335846e+00 8.9848280e-01 8.8666964e-01 5.4930717e-01
  1.1327354e+00 1.1533052e+00 1.1774570e+00 1.0359085e+00 8.2688749e-01
  1.0213267e+00 9.5670927e-01 8.3332598e-01 9.4223446e-01 1.1137081e+00
  1.3203831e+00 3.8361305e-01 1.5113279e+00 1.0622650e+00 2.2310276e+00
  3.1438534e+00 1.5341434e+00 8.9911330e-01 9.3426996e-01 1.6448414e-05
  9.9572796e-01 9.8133558e-01 2.1221871e+00 1.6448414e-05 6.1179495e-01
  1.6448414e-05 1.0322289e+00 1.0806324e+00 1.0438643e+00 1.4394158e+00
  2.0331843e+00 1.7525649e+00]]
start testing...
sorted_indices： [55 54 62 70 71 56 52 69 26 13 14 50 20 27 31 36 15 35 16  4 42 19 41 40
  0 49 18 67 53 68 43 17 66  7 45 60 61  3 46 48  6 58  8 57 37  9 12 38
  2 29 28 30 32 47 44 25 34 24 21 33 22 23 64 11 39 51  5 10  1 65 63 59]
Macro-F1: 0.7692337183191561
Micro-F1: 0.9487013086167143
loss_history [15.66061407799595, 8.868377488579368, 7.40241601230412, 6.609748503629463, 5.387466282538904, 4.726434169726538, 4.324273741964421, 4.021922122473291, 3.724572070383057, 3.4383380801846504, 3.181463040664299, 2.953790927912133, 2.7909493397407865, 2.651984796396199, 2.5409427848779162, 2.407799419819385, 2.330869346145411, 2.27830459874796, 2.1969752255897417, 2.090545031432083, 2.0517296357088926, 1.958268112675835, 1.894126773205171, 1.9856092598730917, 1.855508915852142, 1.7460809123531065, 1.749807341444877, 1.667869771905259, 1.6474191133677336, 1.6271099515000196]
macro_F1List [0.24411278967889705, 0.3296597543309427, 0.4098397284015146, 0.4860456547848469, 0.5408205463940589, 0.5674835901656677, 0.5876054413865655, 0.611730013917239, 0.63060948695764, 0.6467884348589237, 0.667539444844462, 0.6807376134757985, 0.6843678647611802, 0.691549548594859, 0.6962892737713938, 0.6960193291907525, 0.7049195031204287, 0.7236804830647214, 0.7221283037265177, 0.7268775657666497, 0.7417621443230791, 0.7295264840257718, 0.7329966320959929, 0.7557975247543393, 0.7549662607052047, 0.7566046837002824, 0.7543535873130975, 0.7564245753973325, 0.7636819300621572, 0.7692337183191561]
micro_F1List [0.813113652674495, 0.8431950403884622, 0.8610988104872574, 0.872978668173281, 0.8881109804700026, 0.8937149750339751, 0.8993571439478386, 0.9035257829559162, 0.9070301882758937, 0.9087403991510025, 0.9124509459603903, 0.9163141901693415, 0.9158942723205424, 0.9196506283497992, 0.9226205927713051, 0.9246209287055841, 0.9298050054207577, 0.929911893600452, 0.934141611568355, 0.9349890821359312, 0.9350043518758876, 0.934698957076761, 0.935584601994228, 0.9394173067232665, 0.9361648521125685, 0.9426163172441173, 0.940043366061476, 0.9378750629876773, 0.9443036235092916, 0.9487013086167143]
starting retraining
K= 2 top_k_indices [55 54]
BETA = 0.999, GAMMA = 2
init data completed!
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
2024-11-15 05:33:17.491079: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-15 05:33:17.491588: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-15 05:33:17.491635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-15 05:33:17.491701: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-15 05:33:17.491722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-15 05:33:17.491741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-15 05:33:17.491762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-15 05:33:17.491782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-15 05:33:17.491804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-15 05:33:17.491823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-15 05:33:17.492136: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-15 05:33:17.492184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-15 05:33:17.492195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-15 05:33:17.492203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-15 05:33:17.492565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21759 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
start retraining...
Macro-F1: 0.043507017440050796
Micro-F1: 0.48693673746736094
Epoch 1 completed, average loss: 28.421645415793115, duration: 351.98 seconds
Macro-F1: 0.04165426189293201
Micro-F1: 0.4895096886500023
Epoch 2 completed, average loss: 21.912371530760566, duration: 362.17 seconds
Macro-F1: 0.05975145266888791
Micro-F1: 0.4924949228114645
Epoch 3 completed, average loss: 21.073357900516427, duration: 358.31 seconds
Macro-F1: 0.06251496072053293
Micro-F1: 0.49278504787063476
Epoch 4 completed, average loss: 20.697089433370397, duration: 364.83 seconds
Macro-F1: 0.07020376277883722
Micro-F1: 0.494655591015285
Epoch 5 completed, average loss: 20.43916102218788, duration: 354.16 seconds
Macro-F1: 0.08011901199295846
Micro-F1: 0.49792331536593937
Epoch 6 completed, average loss: 20.22416930084804, duration: 346.71 seconds
Macro-F1: 0.08393253560340772
Micro-F1: 0.4996335262410481
Epoch 7 completed, average loss: 20.04703615577739, duration: 362.34 seconds
Macro-F1: 0.08913464678102123
Micro-F1: 0.5008092962176854
Epoch 8 completed, average loss: 19.914539824183336, duration: 369.01 seconds
Macro-F1: 0.09336412849754294
Micro-F1: 0.5017483852249996
Epoch 9 completed, average loss: 19.812864573670073, duration: 358.25 seconds
Macro-F1: 0.09550443051644211
Micro-F1: 0.5023744445632091
Epoch 10 completed, average loss: 19.729961034889044, duration: 353.42 seconds
Macro-F1: 0.10025791688634526
Micro-F1: 0.5042907969277283
Epoch 11 completed, average loss: 19.660611763927395, duration: 347.41 seconds
Macro-F1: 0.10272063907457046
Micro-F1: 0.5051382674953045
Epoch 12 completed, average loss: 19.599692754581678, duration: 354.85 seconds
Macro-F1: 0.10330233384796522
Micro-F1: 0.5049473957458505
Epoch 13 completed, average loss: 19.543880391929957, duration: 370.17 seconds
Macro-F1: 0.10384596801767876
Micro-F1: 0.5052756951549116
Epoch 14 completed, average loss: 19.491512742859577, duration: 360.67 seconds
Macro-F1: 0.10389793055029077
Micro-F1: 0.5051993464551299
Epoch 15 completed, average loss: 19.441988203083067, duration: 349.46 seconds
Macro-F1: 0.10399104937824942
Micro-F1: 0.5051153628853701
Epoch 16 completed, average loss: 19.395035609471833, duration: 353.95 seconds
Macro-F1: 0.10400162734543765
Micro-F1: 0.5052146161950862
Epoch 17 completed, average loss: 19.350490462195687, duration: 372.28 seconds
Macro-F1: 0.10453850979046371
Micro-F1: 0.505344408984715
Epoch 18 completed, average loss: 19.308335074930945, duration: 340.39 seconds
Macro-F1: 0.10497382706527429
Micro-F1: 0.5055658202140818
Epoch 19 completed, average loss: 19.268764133876868, duration: 341.93 seconds
Macro-F1: 0.10498200719652322
Micro-F1: 0.5056116294339508
Epoch 20 completed, average loss: 19.231694996981226, duration: 332.57 seconds
Macro-F1: 0.10541680202772502
Micro-F1: 0.5058025011834049
Epoch 21 completed, average loss: 19.196921180769845, duration: 324.51 seconds
Macro-F1: 0.10555222851532657
Micro-F1: 0.5059170242330773
Epoch 22 completed, average loss: 19.16416683444729, duration: 330.71 seconds
Macro-F1: 0.10886677190938356
Micro-F1: 0.5060391821527279
Epoch 23 completed, average loss: 19.133185262803906, duration: 323.22 seconds
Macro-F1: 0.11393622366349587
Micro-F1: 0.5065659881812212
Epoch 24 completed, average loss: 19.10362116162828, duration: 336.22 seconds
Macro-F1: 0.12661246003446325
Micro-F1: 0.5070698895997802
Epoch 25 completed, average loss: 19.075503976563805, duration: 323.07 seconds
Macro-F1: 0.11200991273292644
Micro-F1: 0.5064667348715052
Epoch 26 completed, average loss: 19.048642531268307, duration: 341.66 seconds
Macro-F1: 0.11204115556383855
Micro-F1: 0.5064667348715052
Epoch 27 completed, average loss: 19.02295618772407, duration: 320.06 seconds
Macro-F1: 0.11146076524078687
Micro-F1: 0.5067950342805662
Epoch 28 completed, average loss: 18.99846042006596, duration: 311.80 seconds
Macro-F1: 0.11119704718189723
Micro-F1: 0.5068026691505444
Epoch 29 completed, average loss: 18.97512470312482, duration: 334.53 seconds
Macro-F1: 0.11108535958861296
Micro-F1: 0.5065812579211776
Epoch 30 completed, average loss: 18.952835047849312, duration: 329.66 seconds
dnn2_loss_history [28.421645415793115, 21.912371530760566, 21.073357900516427, 20.697089433370397, 20.43916102218788, 20.22416930084804, 20.04703615577739, 19.914539824183336, 19.812864573670073, 19.729961034889044, 19.660611763927395, 19.599692754581678, 19.543880391929957, 19.491512742859577, 19.441988203083067, 19.395035609471833, 19.350490462195687, 19.308335074930945, 19.268764133876868, 19.231694996981226, 19.196921180769845, 19.16416683444729, 19.133185262803906, 19.10362116162828, 19.075503976563805, 19.048642531268307, 19.02295618772407, 18.99846042006596, 18.97512470312482, 18.952835047849312]
dnn2_macro_F1List [0.043507017440050796, 0.04165426189293201, 0.05975145266888791, 0.06251496072053293, 0.07020376277883722, 0.08011901199295846, 0.08393253560340772, 0.08913464678102123, 0.09336412849754294, 0.09550443051644211, 0.10025791688634526, 0.10272063907457046, 0.10330233384796522, 0.10384596801767876, 0.10389793055029077, 0.10399104937824942, 0.10400162734543765, 0.10453850979046371, 0.10497382706527429, 0.10498200719652322, 0.10541680202772502, 0.10555222851532657, 0.10886677190938356, 0.11393622366349587, 0.12661246003446325, 0.11200991273292644, 0.11204115556383855, 0.11146076524078687, 0.11119704718189723, 0.11108535958861296]
dnn2_micro_F1List [0.48693673746736094, 0.4895096886500023, 0.4924949228114645, 0.49278504787063476, 0.494655591015285, 0.49792331536593937, 0.4996335262410481, 0.5008092962176854, 0.5017483852249996, 0.5023744445632091, 0.5042907969277283, 0.5051382674953045, 0.5049473957458505, 0.5052756951549116, 0.5051993464551299, 0.5051153628853701, 0.5052146161950862, 0.505344408984715, 0.5055658202140818, 0.5056116294339508, 0.5058025011834049, 0.5059170242330773, 0.5060391821527279, 0.5065659881812212, 0.5070698895997802, 0.5064667348715052, 0.5064667348715052, 0.5067950342805662, 0.5068026691505444, 0.5065812579211776]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
Processed 90000 rows
Processed 100000 rows
Processed 110000 rows
Processed 120000 rows
Processed 130000 rows
0 0.0 0 1412
1 0.24124809741248096 634 2628
10 0.0 0 139
11 0.6410406313943291 2193 3421
12 0.0 0 13
13 0.6071428571428571 85 140
14 0.0 0 17
15 0.0 0 1232
16 0.0 0 309
17 0.0 0 400
18 0.0 0 102
19 0.0 0 359
2 0.0 0 833
20 0.029642248722316866 87 2935
21 0.0 0 461
22 0.0 0 30
23 0.0 0 23059
24 0.033045854324993594 387 11711
25 0.0 0 347
26 0.0 0 4
27 0.0 0 50
28 0.9960360360360361 60808 61050
3 0.0 0 832
4 0.2610275038920602 503 1927
5 0.0 0 12492
6 0.02002503128911139 16 799
7 0.0 0 1700
8 0.6599516518936341 1638 2482
9 0.0 0 94
Top-1 accuracy: 0.5065812579211776
Top-3 accuracy: 0.8229702698163051
Top-5 accuracy: 0.9318358808349494
