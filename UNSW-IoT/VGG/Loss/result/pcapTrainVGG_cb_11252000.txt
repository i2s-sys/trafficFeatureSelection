2024-11-25 12:00:27.662910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainVGG_cb.py
2024-11-25 12:00:30.179789: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-25 12:00:30.192277: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-25 12:00:30.193700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-25 12:00:30.214396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:31:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.59GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-25 12:00:30.214486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-25 12:00:30.218292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-25 12:00:30.218362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-25 12:00:30.219899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-25 12:00:30.220204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-25 12:00:30.224685: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-25 12:00:30.225566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-25 12:00:30.225787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-25 12:00:30.228243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-25 12:00:30.228280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-25 12:00:30.964985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-25 12:00:30.965051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-25 12:00:30.965064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-25 12:00:30.969210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21237 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:31:00.0, compute capability: 8.6)
BETA = 0.9999, GAMMA = 2
init data completed!
2024-11-25 12:01:18.986244: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-25 12:01:18.987844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:31:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.59GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-25 12:01:18.987876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-25 12:01:18.987948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-25 12:01:18.987976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-25 12:01:18.987998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-25 12:01:18.988031: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-25 12:01:18.988052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-25 12:01:18.988076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-25 12:01:18.988094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-25 12:01:18.990201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-25 12:01:19.028704: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-25 12:01:19.030481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:31:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.59GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-25 12:01:19.030532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-25 12:01:19.030576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-25 12:01:19.030590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-25 12:01:19.030600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-25 12:01:19.030609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-25 12:01:19.030619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-25 12:01:19.030628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-25 12:01:19.030639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-25 12:01:19.033053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-25 12:01:19.033137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-25 12:01:19.033144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-25 12:01:19.033149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-25 12:01:19.035316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21237 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:31:00.0, compute capability: 8.6)
2024-11-25 12:01:19.333734: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-25 12:01:19.346050: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-25 12:01:19.982138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-25 12:01:20.619092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-25 12:01:20.622723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-25 12:01:23.167128: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-25 12:01:23.306616: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-25 12:01:55.988104: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 4.764322784764026, duration: 126.03 seconds
Macro-F1: 0.5752082421672398
Micro-F1: 0.8664126799920597
Epoch 2 completed, average loss: 1.6605454092001786, duration: 50.22 seconds
Macro-F1: 0.6353925828559317
Micro-F1: 0.8847287330696757
Epoch 3 completed, average loss: 1.2666647976282306, duration: 49.28 seconds
Macro-F1: 0.6444206219836076
Micro-F1: 0.8999526638061354
Epoch 4 completed, average loss: 1.1568314908723927, duration: 47.36 seconds
Macro-F1: 0.6792216274404561
Micro-F1: 0.9134740185374643
Epoch 5 completed, average loss: 1.0883242463186589, duration: 48.73 seconds
Macro-F1: 0.7117852092406634
Micro-F1: 0.9243689779963047
Epoch 6 completed, average loss: 0.9246624162756952, duration: 39.46 seconds
Macro-F1: 0.7252580963970816
Micro-F1: 0.9314617722060193
Epoch 7 completed, average loss: 0.6902653680600079, duration: 46.84 seconds
Macro-F1: 0.7427997541773222
Micro-F1: 0.932889492891936
Epoch 8 completed, average loss: 0.6969437895863188, duration: 53.94 seconds
Macro-F1: 0.7576486187983668
Micro-F1: 0.9360274244529616
Epoch 9 completed, average loss: 0.8022232806839901, duration: 67.01 seconds
Macro-F1: 0.7444969228327527
Micro-F1: 0.9355158881644245
Epoch 10 completed, average loss: 0.6156483150310081, duration: 54.11 seconds
Macro-F1: 0.7671585357682638
Micro-F1: 0.9422880178350562
Epoch 11 completed, average loss: 0.578368636235988, duration: 54.48 seconds
Macro-F1: 0.7568342155236043
Micro-F1: 0.9391806257539435
Epoch 12 completed, average loss: 0.44836186063423233, duration: 79.25 seconds
Macro-F1: 0.7784094396011979
Micro-F1: 0.9457313441952084
Epoch 13 completed, average loss: 0.5114811161602447, duration: 53.32 seconds
Macro-F1: 0.7653661869573404
Micro-F1: 0.9450060315472829
Epoch 14 completed, average loss: 0.4723495644399023, duration: 53.79 seconds
Macro-F1: 0.7817884592711977
Micro-F1: 0.9463039594435707
Epoch 15 completed, average loss: 0.39446762370536353, duration: 53.16 seconds
Macro-F1: 0.7996661170455307
Micro-F1: 0.9462581502237017
Epoch 16 completed, average loss: 0.3633746422630601, duration: 52.97 seconds
Macro-F1: 0.7856322228229492
Micro-F1: 0.9485867855670418
Epoch 17 completed, average loss: 0.3580328766506276, duration: 53.46 seconds
Macro-F1: 0.803043743409154
Micro-F1: 0.9535723556627831
Epoch 18 completed, average loss: 0.5640663858073922, duration: 53.34 seconds
Macro-F1: 0.7961486641486083
Micro-F1: 0.9541755103910581
Epoch 19 completed, average loss: 0.35619010242341287, duration: 46.04 seconds
Macro-F1: 0.7914088760752107
Micro-F1: 0.9525798225656217
Epoch 20 completed, average loss: 0.4425829221070387, duration: 46.26 seconds
Macro-F1: 0.7888164924702927
Micro-F1: 0.9507474537708622
Epoch 21 completed, average loss: 0.3459438489703988, duration: 46.21 seconds
Macro-F1: 0.8007082655450641
Micro-F1: 0.9560078791858174
Epoch 22 completed, average loss: 0.4451642556386759, duration: 46.15 seconds
Macro-F1: 0.7897292867780316
Micro-F1: 0.9500221411229367
Epoch 23 completed, average loss: 0.44861557564078186, duration: 46.48 seconds
Macro-F1: 0.8073497226381222
Micro-F1: 0.9561834811953153
Epoch 24 completed, average loss: 0.300427568514582, duration: 46.30 seconds
Macro-F1: 0.8142660585952266
Micro-F1: 0.9607109590923667
Epoch 25 completed, average loss: 0.3669346385000638, duration: 46.44 seconds
Macro-F1: 0.8131174163176065
Micro-F1: 0.9606193406526287
Epoch 26 completed, average loss: 0.26669903689446056, duration: 46.64 seconds
Macro-F1: 0.811836506250842
Micro-F1: 0.9585655606285025
Epoch 27 completed, average loss: 0.3279052582125803, duration: 46.26 seconds
Macro-F1: 0.8123411328697546
Micro-F1: 0.9622684725679121
Epoch 28 completed, average loss: 0.34933030713313684, duration: 46.49 seconds
Macro-F1: 0.8130343069103477
Micro-F1: 0.9611232420711875
Epoch 29 completed, average loss: 0.2864663522717066, duration: 46.00 seconds
Macro-F1: 0.8135923918659744
Micro-F1: 0.9646429171311213
Epoch 30 completed, average loss: 0.25497593610556457, duration: 46.27 seconds
Macro-F1: 0.8370816545203524
Micro-F1: 0.9665058254057933
loss_history [4.764322784764026, 1.6605454092001786, 1.2666647976282306, 1.1568314908723927, 1.0883242463186589, 0.9246624162756952, 0.6902653680600079, 0.6969437895863188, 0.8022232806839901, 0.6156483150310081, 0.578368636235988, 0.44836186063423233, 0.5114811161602447, 0.4723495644399023, 0.39446762370536353, 0.3633746422630601, 0.3580328766506276, 0.5640663858073922, 0.35619010242341287, 0.4425829221070387, 0.3459438489703988, 0.4451642556386759, 0.44861557564078186, 0.300427568514582, 0.3669346385000638, 0.26669903689446056, 0.3279052582125803, 0.34933030713313684, 0.2864663522717066, 0.25497593610556457]
macro_F1List [0.8664126799920597, 0.8847287330696757, 0.8999526638061354, 0.9134740185374643, 0.9243689779963047, 0.9314617722060193, 0.932889492891936, 0.9360274244529616, 0.9355158881644245, 0.9422880178350562, 0.9391806257539435, 0.9457313441952084, 0.9450060315472829, 0.9463039594435707, 0.9462581502237017, 0.9485867855670418, 0.9535723556627831, 0.9541755103910581, 0.9525798225656217, 0.9507474537708622, 0.9560078791858174, 0.9500221411229367, 0.9561834811953153, 0.9607109590923667, 0.9606193406526287, 0.9585655606285025, 0.9622684725679121, 0.9611232420711875, 0.9646429171311213, 0.9665058254057933]
micro_F1List [0.5752082421672398, 0.6353925828559317, 0.6444206219836076, 0.6792216274404561, 0.7117852092406634, 0.7252580963970816, 0.7427997541773222, 0.7576486187983668, 0.7444969228327527, 0.7671585357682638, 0.7568342155236043, 0.7784094396011979, 0.7653661869573404, 0.7817884592711977, 0.7996661170455307, 0.7856322228229492, 0.803043743409154, 0.7961486641486083, 0.7914088760752107, 0.7888164924702927, 0.8007082655450641, 0.7897292867780316, 0.8073497226381222, 0.8142660585952266, 0.8131174163176065, 0.811836506250842, 0.8123411328697546, 0.8130343069103477, 0.8135923918659744, 0.8370816545203524]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
Processed 90000 rows
Processed 100000 rows
Processed 110000 rows
Processed 120000 rows
Processed 130000 rows
0 0.9957507082152974 1406 1412
1 0.9611872146118722 2526 2628
10 1.0 139 139
11 0.9991230634317451 3418 3421
12 1.0 13 13
13 0.9714285714285714 136 140
14 0.9411764705882353 16 17
15 0.9756493506493507 1202 1232
16 1.0 309 309
17 0.995 398 400
18 0.9509803921568627 97 102
19 0.9749303621169917 350 359
2 0.9819927971188476 818 833
20 0.7696763202725724 2259 2935
21 0.9913232104121475 457 461
22 0.3333333333333333 10 30
23 0.9342122381716467 21542 23059
24 0.9067543335325762 10619 11711
25 0.7002881844380403 243 347
26 0.5 2 4
27 0.58 29 50
28 0.9894185094185094 60404 61050
3 0.9951923076923077 828 832
4 0.9994810586403736 1926 1927
5 0.9948767211015049 12428 12492
6 0.9949937421777222 795 799
7 0.9994117647058823 1699 1700
8 0.9794520547945206 2431 2482
9 0.9680851063829787 91 94
Top-1 accuracy: 0.9665058254057933
Top-3 accuracy: 0.9961367557910489
Top-5 accuracy: 0.9994273847516377
Macro-F1: 0.8370816545203524
Micro-F1: 0.9665058254057933
