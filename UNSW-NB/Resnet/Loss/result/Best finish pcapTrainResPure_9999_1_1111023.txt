2024-11-11 10:43:50.031953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainResPure_9999_1.py
2024-11-11 10:43:52.201221: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-11 10:43:52.211859: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-11 10:43:52.214086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-11 10:43:52.240367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-11 10:43:52.240408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-11 10:43:52.243560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-11 10:43:52.243650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-11 10:43:52.244838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-11 10:43:52.245138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-11 10:43:52.248163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-11 10:43:52.248868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-11 10:43:52.249059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-11 10:43:52.249457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-11 10:43:52.249488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-11 10:43:52.860255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-11 10:43:52.860301: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-11 10:43:52.860310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-11 10:43:52.860995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22422 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
BETA = 0.9999, GAMMA = 1
init data completed!
2024-11-11 10:44:08.100226: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-11 10:44:08.100619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-11 10:44:08.100654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-11 10:44:08.100701: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-11 10:44:08.100715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-11 10:44:08.100729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-11 10:44:08.100754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-11 10:44:08.100767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-11 10:44:08.100780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-11 10:44:08.100794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-11 10:44:08.101106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-11 10:44:09.045974: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-11 10:44:09.046377: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-11 10:44:09.046411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-11 10:44:09.046446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-11 10:44:09.046459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-11 10:44:09.046473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-11 10:44:09.046487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-11 10:44:09.046501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-11 10:44:09.046514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-11 10:44:09.046527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-11 10:44:09.046839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-11 10:44:09.046865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-11 10:44:09.046874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-11 10:44:09.046881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-11 10:44:09.047228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22422 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
2024-11-11 10:44:10.693406: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-11 10:44:10.829742: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-11 10:44:13.693540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-11 10:44:14.412962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-11 10:44:14.437537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-11 10:44:16.720624: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-11 10:44:16.900626: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-11 10:44:58.430835: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 10.353316201007305, duration: 224.80 seconds
Macro-F1: 0.8490003753978325
Micro-F1: 0.8494874410921635
Epoch 2 completed, average loss: 8.057086827025264, duration: 113.20 seconds
Macro-F1: 0.8770306453483844
Micro-F1: 0.8792085701792741
Epoch 3 completed, average loss: 7.740255031383673, duration: 111.98 seconds
Macro-F1: 0.8799406102606111
Micro-F1: 0.8822086187630569
Epoch 4 completed, average loss: 7.554494725778383, duration: 111.90 seconds
Macro-F1: 0.8820473407895253
Micro-F1: 0.8847592673565564
Epoch 5 completed, average loss: 7.382726978959612, duration: 111.99 seconds
Macro-F1: 0.8841826260013421
Micro-F1: 0.8872491862216392
Epoch 6 completed, average loss: 7.2378746724807925, duration: 112.51 seconds
Macro-F1: 0.8841159982655895
Micro-F1: 0.8873584997327894
Epoch 7 completed, average loss: 7.114534000134799, duration: 112.70 seconds
Macro-F1: 0.8818324130920409
Micro-F1: 0.8856580673371228
Epoch 8 completed, average loss: 7.014054523061191, duration: 111.21 seconds
Macro-F1: 0.8836000322321825
Micro-F1: 0.8863989700238061
Epoch 9 completed, average loss: 6.942309308522282, duration: 112.36 seconds
Macro-F1: 0.8802506383628863
Micro-F1: 0.8840426565612398
Epoch 10 completed, average loss: 6.868301438971799, duration: 113.67 seconds
Macro-F1: 0.8788125809910201
Micro-F1: 0.8818928241752902
Epoch 11 completed, average loss: 6.822285037392504, duration: 111.87 seconds
Macro-F1: 0.8774364613358816
Micro-F1: 0.8813462566195404
Epoch 12 completed, average loss: 6.740346795020093, duration: 112.52 seconds
Macro-F1: 0.8555080742017329
Micro-F1: 0.8612811543506778
Epoch 13 completed, average loss: 6.679993651921597, duration: 112.54 seconds
Macro-F1: 0.8527317803612464
Micro-F1: 0.8582325219841617
Epoch 14 completed, average loss: 6.624679154771536, duration: 113.56 seconds
Macro-F1: 0.8529421171719066
Micro-F1: 0.8586454841373949
Epoch 15 completed, average loss: 6.594737513384042, duration: 118.84 seconds
Macro-F1: 0.8637592867934618
Micro-F1: 0.8685687217606762
Epoch 16 completed, average loss: 6.486978950946326, duration: 116.51 seconds
Macro-F1: 0.8713967888953946
Micro-F1: 0.8752975756692416
Epoch 17 completed, average loss: 6.395920861106967, duration: 112.84 seconds
Macro-F1: 0.8748462125424192
Micro-F1: 0.8783704999271243
Epoch 18 completed, average loss: 6.321481321309064, duration: 112.87 seconds
Macro-F1: 0.8715553746045257
Micro-F1: 0.8756255162026916
Epoch 19 completed, average loss: 6.225476075908056, duration: 113.16 seconds
Macro-F1: 0.878247459646946
Micro-F1: 0.8817227809357236
Epoch 20 completed, average loss: 6.115626601862855, duration: 109.35 seconds
Macro-F1: 0.8792614967587513
Micro-F1: 0.8827916241558567
loss_history [10.353316201007305, 8.057086827025264, 7.740255031383673, 7.554494725778383, 7.382726978959612, 7.2378746724807925, 7.114534000134799, 7.014054523061191, 6.942309308522282, 6.868301438971799, 6.822285037392504, 6.740346795020093, 6.679993651921597, 6.624679154771536, 6.594737513384042, 6.486978950946326, 6.395920861106967, 6.321481321309064, 6.225476075908056, 6.115626601862855]
macro_F1List [0.8494874410921635, 0.8792085701792741, 0.8822086187630569, 0.8847592673565564, 0.8872491862216392, 0.8873584997327894, 0.8856580673371228, 0.8863989700238061, 0.8840426565612398, 0.8818928241752902, 0.8813462566195404, 0.8612811543506778, 0.8582325219841617, 0.8586454841373949, 0.8685687217606762, 0.8752975756692416, 0.8783704999271243, 0.8756255162026916, 0.8817227809357236, 0.8827916241558567]
micro_F1List [0.8490003753978325, 0.8770306453483844, 0.8799406102606111, 0.8820473407895253, 0.8841826260013421, 0.8841159982655895, 0.8818324130920409, 0.8836000322321825, 0.8802506383628863, 0.8788125809910201, 0.8774364613358816, 0.8555080742017329, 0.8527317803612464, 0.8529421171719066, 0.8637592867934618, 0.8713967888953946, 0.8748462125424192, 0.8715553746045257, 0.878247459646946, 0.8792614967587513]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
0 0.7919459459459459 29302 37000
1 0.9569399099973529 43380 45332
Top-1 accuracy: 0.8827916241558568
Top-3 accuracy: 1.0
Top-5 accuracy: 1.0
Macro-F1: 0.8792614967587513
Micro-F1: 0.8827916241558567
