2024-11-22 17:11:01.646312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainVGG_999_2.py
2024-11-22 17:11:03.697063: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-22 17:11:03.706115: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-22 17:11:03.708615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-22 17:11:03.736100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-22 17:11:03.736144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-22 17:11:03.739395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-22 17:11:03.739481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-22 17:11:03.740674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-22 17:11:03.740991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-22 17:11:03.744277: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-22 17:11:03.744977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-22 17:11:03.745163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-22 17:11:03.745548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-22 17:11:03.745581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-22 17:11:04.359491: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-22 17:11:04.359546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-22 17:11:04.359555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-22 17:11:04.360255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22259 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
BETA = 0.999, GAMMA = 2
init data completed!
2024-11-22 17:11:12.384027: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-22 17:11:12.384555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-22 17:11:12.384598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-22 17:11:12.384648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-22 17:11:12.384660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-22 17:11:12.384673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-22 17:11:12.384697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-22 17:11:12.384710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-22 17:11:12.384723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-22 17:11:12.384736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-22 17:11:12.385054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-22 17:11:12.435404: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-22 17:11:12.435874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-22 17:11:12.435916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-22 17:11:12.435979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-22 17:11:12.435996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-22 17:11:12.436012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-22 17:11:12.436028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-22 17:11:12.436043: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-22 17:11:12.436059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-22 17:11:12.436075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-22 17:11:12.436392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-22 17:11:12.436427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-22 17:11:12.436436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-22 17:11:12.436443: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-22 17:11:12.436756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22259 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
2024-11-22 17:11:12.806364: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-22 17:11:12.823101: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-22 17:11:13.561227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-22 17:11:14.230929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-22 17:11:14.235752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-22 17:11:16.383015: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-22 17:11:16.540041: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-22 17:11:48.074427: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 3.2805143867172606, duration: 96.58 seconds
Macro-F1: 0.772227897833947
Micro-F1: 0.772444996451384
Epoch 2 completed, average loss: 1.1705182591165468, duration: 14.12 seconds
Macro-F1: 0.7858693963486514
Micro-F1: 0.7864620298083748
Epoch 3 completed, average loss: 0.8553607344260151, duration: 14.16 seconds
Macro-F1: 0.7571857235550696
Micro-F1: 0.758915897799858
Epoch 4 completed, average loss: 0.7053466819063949, duration: 14.08 seconds
Macro-F1: 0.76023061285836
Micro-F1: 0.7618435060326473
Epoch 5 completed, average loss: 0.619604763777442, duration: 13.94 seconds
Macro-F1: 0.7611191147132669
Micro-F1: 0.7626863023420867
Epoch 6 completed, average loss: 0.6023336357448432, duration: 13.95 seconds
Macro-F1: 0.7643981074486617
Micro-F1: 0.7658356990773598
Epoch 7 completed, average loss: 0.5618718112998725, duration: 13.97 seconds
Macro-F1: 0.7825135893190025
Micro-F1: 0.7832682753726047
Epoch 8 completed, average loss: 0.5152762040251684, duration: 13.99 seconds
Macro-F1: 0.7639186767510087
Micro-F1: 0.7653477643718949
Epoch 9 completed, average loss: 0.4849263779890943, duration: 13.86 seconds
Macro-F1: 0.7586407492444249
Micro-F1: 0.7603353442157559
Epoch 10 completed, average loss: 0.46223240959783635, duration: 14.69 seconds
Macro-F1: 0.7575722648724253
Micro-F1: 0.7592707594038325
Epoch 11 completed, average loss: 0.4336757134027189, duration: 13.96 seconds
Macro-F1: 0.7639115099921457
Micro-F1: 0.7653034066713982
Epoch 12 completed, average loss: 0.4280712301991937, duration: 14.09 seconds
Macro-F1: 0.7453866790611263
Micro-F1: 0.7471611071682044
Epoch 13 completed, average loss: 0.3814285215022557, duration: 13.77 seconds
Macro-F1: 0.7416380471941724
Micro-F1: 0.7435237757274664
Epoch 14 completed, average loss: 0.37117942424710626, duration: 14.02 seconds
Macro-F1: 0.7543685358838853
Micro-F1: 0.7562100780695529
Epoch 15 completed, average loss: 0.38212589271332525, duration: 13.95 seconds
Macro-F1: 0.7553316192052322
Micro-F1: 0.7571415897799857
Epoch 16 completed, average loss: 0.35744157613669636, duration: 14.47 seconds
Macro-F1: 0.758233273147733
Micro-F1: 0.7599361249112845
Epoch 17 completed, average loss: 0.320068336022607, duration: 13.29 seconds
Macro-F1: 0.7652593193510062
Micro-F1: 0.7663236337828248
Epoch 18 completed, average loss: 0.3177369139474302, duration: 14.21 seconds
Macro-F1: 0.7545249081951908
Micro-F1: 0.756431866572037
Epoch 19 completed, average loss: 0.2987559763298226, duration: 14.46 seconds
Macro-F1: 0.7520524321083799
Micro-F1: 0.7539921930447125
Epoch 20 completed, average loss: 0.2900081488689052, duration: 14.59 seconds
Macro-F1: 0.7676426797536461
Micro-F1: 0.7689407381121363
Epoch 21 completed, average loss: 0.2879362666891411, duration: 14.44 seconds
Macro-F1: 0.7529773200669723
Micro-F1: 0.7548349893541518
Epoch 22 completed, average loss: 0.25659083071345445, duration: 14.54 seconds
Macro-F1: 0.7516986979388443
Micro-F1: 0.7536373314407381
Epoch 23 completed, average loss: 0.26978995904417064, duration: 14.65 seconds
Macro-F1: 0.7685810104925042
Micro-F1: 0.769694819020582
Epoch 24 completed, average loss: 0.24626619727247842, duration: 14.57 seconds
Macro-F1: 0.7588156571278628
Micro-F1: 0.7604240596167494
Epoch 25 completed, average loss: 0.24089949837260183, duration: 14.63 seconds
Macro-F1: 0.7724394080347095
Micro-F1: 0.7735095812633073
Epoch 26 completed, average loss: 0.24337255361774437, duration: 14.29 seconds
Macro-F1: 0.8397743249801983
Micro-F1: 0.8397799858055357
Epoch 27 completed, average loss: 0.2397215187285904, duration: 14.62 seconds
Macro-F1: 0.7671431491386268
Micro-F1: 0.7682753726046841
Epoch 28 completed, average loss: 0.2137369388946524, duration: 14.48 seconds
Macro-F1: 0.7776360452473943
Micro-F1: 0.7785220014194464
Epoch 29 completed, average loss: 0.20291156205742045, duration: 14.50 seconds
Macro-F1: 0.7587657217047955
Micro-F1: 0.7604684173172462
Epoch 30 completed, average loss: 0.20563867506691197, duration: 14.64 seconds
Macro-F1: 0.7562248450580862
Micro-F1: 0.7579400283889283
loss_history [3.2805143867172606, 1.1705182591165468, 0.8553607344260151, 0.7053466819063949, 0.619604763777442, 0.6023336357448432, 0.5618718112998725, 0.5152762040251684, 0.4849263779890943, 0.46223240959783635, 0.4336757134027189, 0.4280712301991937, 0.3814285215022557, 0.37117942424710626, 0.38212589271332525, 0.35744157613669636, 0.320068336022607, 0.3177369139474302, 0.2987559763298226, 0.2900081488689052, 0.2879362666891411, 0.25659083071345445, 0.26978995904417064, 0.24626619727247842, 0.24089949837260183, 0.24337255361774437, 0.2397215187285904, 0.2137369388946524, 0.20291156205742045, 0.20563867506691197]
macro_F1List [0.772444996451384, 0.7864620298083748, 0.758915897799858, 0.7618435060326473, 0.7626863023420867, 0.7658356990773598, 0.7832682753726047, 0.7653477643718949, 0.7603353442157559, 0.7592707594038325, 0.7653034066713982, 0.7471611071682044, 0.7435237757274664, 0.7562100780695529, 0.7571415897799857, 0.7599361249112845, 0.7663236337828248, 0.756431866572037, 0.7539921930447125, 0.7689407381121363, 0.7548349893541518, 0.7536373314407381, 0.769694819020582, 0.7604240596167494, 0.7735095812633073, 0.8397799858055357, 0.7682753726046841, 0.7785220014194464, 0.7604684173172462, 0.7579400283889283]
micro_F1List [0.772227897833947, 0.7858693963486514, 0.7571857235550696, 0.76023061285836, 0.7611191147132669, 0.7643981074486617, 0.7825135893190025, 0.7639186767510087, 0.7586407492444249, 0.7575722648724253, 0.7639115099921457, 0.7453866790611263, 0.7416380471941724, 0.7543685358838853, 0.7553316192052322, 0.758233273147733, 0.7652593193510062, 0.7545249081951908, 0.7520524321083799, 0.7676426797536461, 0.7529773200669723, 0.7516986979388443, 0.7685810104925042, 0.7588156571278628, 0.7724394080347095, 0.8397743249801983, 0.7671431491386268, 0.7776360452473943, 0.7587657217047955, 0.7562248450580862]
start testing...
Processed 10000 rows
Processed 20000 rows
0 0.9771393265369169 9489 9711
1 0.592067326424063 7598 12833
Top-1 accuracy: 0.7579400283889283
Top-3 accuracy: 1.0
Top-5 accuracy: 1.0
Macro-F1: 0.7562248450580862
Micro-F1: 0.7579400283889283
