2024-11-25 19:44:00.797329: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainVGG_999_1.py
2024-11-25 19:44:02.840958: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-25 19:44:02.851456: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-25 19:44:02.853992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-25 19:44:02.864703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-25 19:44:02.864744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-25 19:44:02.868787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-25 19:44:02.868848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-25 19:44:02.869973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-25 19:44:02.870248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-25 19:44:02.873437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-25 19:44:02.874135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-25 19:44:02.874316: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-25 19:44:02.874699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-25 19:44:02.874728: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-25 19:44:03.521477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-25 19:44:03.521531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-25 19:44:03.521541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-25 19:44:03.522241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22259 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
BETA = 0.999, GAMMA = 1
init data completed!
2024-11-25 19:44:45.490246: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-25 19:44:45.491063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-25 19:44:45.491100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-25 19:44:45.491156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-25 19:44:45.491170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-25 19:44:45.491185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-25 19:44:45.491211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-25 19:44:45.491225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-25 19:44:45.491240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-25 19:44:45.491253: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-25 19:44:45.491571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-25 19:44:45.537344: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-25 19:44:45.537642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-25 19:44:45.537671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-25 19:44:45.537701: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-25 19:44:45.537714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-25 19:44:45.537727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-25 19:44:45.537740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-25 19:44:45.537753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-25 19:44:45.537766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-25 19:44:45.537779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-25 19:44:45.538079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-25 19:44:45.538123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-25 19:44:45.538132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-25 19:44:45.538140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-25 19:44:45.538485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22259 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
2024-11-25 19:44:45.920918: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-25 19:44:45.935172: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-25 19:44:46.685404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-25 19:44:47.329763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-25 19:44:47.351824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-25 19:44:49.467256: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-25 19:44:49.669336: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-25 19:45:24.660704: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 9.550800046588169, duration: 118.57 seconds
Macro-F1: 0.64577997276961
Micro-F1: 0.9163676342591885
Epoch 2 completed, average loss: 2.4344248406723246, duration: 34.35 seconds
Macro-F1: 0.7505010060405721
Micro-F1: 0.9462963245735925
Epoch 3 completed, average loss: 1.8211967539390261, duration: 34.46 seconds
Macro-F1: 0.8128730519309005
Micro-F1: 0.9646047427812304
Epoch 4 completed, average loss: 1.5388682384494963, duration: 34.28 seconds
Macro-F1: 0.8386669149372071
Micro-F1: 0.9678037533020812
Epoch 5 completed, average loss: 1.2507971278264975, duration: 34.29 seconds
Macro-F1: 0.8238282161188574
Micro-F1: 0.9673227564934569
Epoch 6 completed, average loss: 1.3785910807475041, duration: 34.40 seconds
Macro-F1: 0.8417344131769058
Micro-F1: 0.9697659148864695
Epoch 7 completed, average loss: 0.9839136711925356, duration: 32.85 seconds
Macro-F1: 0.8423164429702661
Micro-F1: 0.9713310632319931
Epoch 8 completed, average loss: 0.9175823282873375, duration: 33.63 seconds
Macro-F1: 0.8165909188695286
Micro-F1: 0.9638030814335232
Epoch 9 completed, average loss: 0.7775793200796512, duration: 32.84 seconds
Macro-F1: 0.8242940745912274
Micro-F1: 0.9693918062575394
Epoch 10 completed, average loss: 0.8805635146169319, duration: 32.93 seconds
Macro-F1: 0.8491415301670164
Micro-F1: 0.9674296446731512
Epoch 11 completed, average loss: 0.6831067384247581, duration: 33.02 seconds
Macro-F1: 0.8595750964946931
Micro-F1: 0.9750568797813374
Epoch 12 completed, average loss: 0.6417586792987675, duration: 33.04 seconds
Macro-F1: 0.868450311812596
Micro-F1: 0.9767441860465116
Epoch 13 completed, average loss: 0.5810257944652587, duration: 34.38 seconds
Macro-F1: 0.8426116908553426
Micro-F1: 0.97072027363374
Epoch 14 completed, average loss: 0.6013609724830186, duration: 33.44 seconds
Macro-F1: 0.860938931676191
Micro-F1: 0.9720945502298096
Epoch 15 completed, average loss: 0.5460855066887472, duration: 35.98 seconds
Macro-F1: 0.8445386139746738
Micro-F1: 0.9760417780085205
Epoch 16 completed, average loss: 0.4897458946004987, duration: 36.15 seconds
Macro-F1: 0.844037204901586
Micro-F1: 0.9702316419551376
Epoch 17 completed, average loss: 0.5730522740195312, duration: 36.48 seconds
Macro-F1: 0.8742013980375488
Micro-F1: 0.9800882590969476
Epoch 18 completed, average loss: 0.5665720117867156, duration: 34.28 seconds
Macro-F1: 0.8456266566900759
Micro-F1: 0.9721250897097222
Epoch 19 completed, average loss: 0.5640072885566755, duration: 34.49 seconds
Macro-F1: 0.8744388887498429
Micro-F1: 0.9797294202079738
Epoch 20 completed, average loss: 0.42428661200460194, duration: 34.72 seconds
Macro-F1: 0.8739197908856142
Micro-F1: 0.9801493380567728
Epoch 21 completed, average loss: 0.41865264536297103, duration: 34.33 seconds
Macro-F1: 0.8858660038014342
Micro-F1: 0.9808746507046985
Epoch 22 completed, average loss: 0.3842450949442614, duration: 34.46 seconds
Macro-F1: 0.87666503578797
Micro-F1: 0.9811876803738032
Epoch 23 completed, average loss: 0.36036325962203514, duration: 34.52 seconds
Macro-F1: 0.8904393254798945
Micro-F1: 0.9819740719815542
Epoch 24 completed, average loss: 0.36528074746338124, duration: 34.57 seconds
Macro-F1: 0.8891277779073835
Micro-F1: 0.9832109209180167
Epoch 25 completed, average loss: 0.35068524323495914, duration: 34.42 seconds
Macro-F1: 0.8704829191205224
Micro-F1: 0.9826001313197636
Epoch 26 completed, average loss: 0.32781691492270254, duration: 33.99 seconds
Macro-F1: 0.8805835480989429
Micro-F1: 0.9836232038968377
Epoch 27 completed, average loss: 0.544674768003939, duration: 34.97 seconds
Macro-F1: 0.8775973610523881
Micro-F1: 0.9827757333292614
Epoch 28 completed, average loss: 0.3336407207657794, duration: 34.00 seconds
Macro-F1: 0.8909144633892666
Micro-F1: 0.9836308387668158
Epoch 29 completed, average loss: 0.29002439390550355, duration: 34.11 seconds
Macro-F1: 0.8945097270200211
Micro-F1: 0.9843714211546979
Epoch 30 completed, average loss: 0.2894178986816445, duration: 33.84 seconds
Macro-F1: 0.8974476395972021
Micro-F1: 0.9834399670173617
loss_history [9.550800046588169, 2.4344248406723246, 1.8211967539390261, 1.5388682384494963, 1.2507971278264975, 1.3785910807475041, 0.9839136711925356, 0.9175823282873375, 0.7775793200796512, 0.8805635146169319, 0.6831067384247581, 0.6417586792987675, 0.5810257944652587, 0.6013609724830186, 0.5460855066887472, 0.4897458946004987, 0.5730522740195312, 0.5665720117867156, 0.5640072885566755, 0.42428661200460194, 0.41865264536297103, 0.3842450949442614, 0.36036325962203514, 0.36528074746338124, 0.35068524323495914, 0.32781691492270254, 0.544674768003939, 0.3336407207657794, 0.29002439390550355, 0.2894178986816445]
macro_F1List [0.9163676342591885, 0.9462963245735925, 0.9646047427812304, 0.9678037533020812, 0.9673227564934569, 0.9697659148864695, 0.9713310632319931, 0.9638030814335232, 0.9693918062575394, 0.9674296446731512, 0.9750568797813374, 0.9767441860465116, 0.97072027363374, 0.9720945502298096, 0.9760417780085205, 0.9702316419551376, 0.9800882590969476, 0.9721250897097222, 0.9797294202079738, 0.9801493380567728, 0.9808746507046985, 0.9811876803738032, 0.9819740719815542, 0.9832109209180167, 0.9826001313197636, 0.9836232038968377, 0.9827757333292614, 0.9836308387668158, 0.9843714211546979, 0.9834399670173617]
micro_F1List [0.64577997276961, 0.7505010060405721, 0.8128730519309005, 0.8386669149372071, 0.8238282161188574, 0.8417344131769058, 0.8423164429702661, 0.8165909188695286, 0.8242940745912274, 0.8491415301670164, 0.8595750964946931, 0.868450311812596, 0.8426116908553426, 0.860938931676191, 0.8445386139746738, 0.844037204901586, 0.8742013980375488, 0.8456266566900759, 0.8744388887498429, 0.8739197908856142, 0.8858660038014342, 0.87666503578797, 0.8904393254798945, 0.8891277779073835, 0.8704829191205224, 0.8805835480989429, 0.8775973610523881, 0.8909144633892666, 0.8945097270200211, 0.8974476395972021]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
Processed 90000 rows
Processed 100000 rows
Processed 110000 rows
Processed 120000 rows
Processed 130000 rows
0 0.9957507082152974 1406 1412
1 0.9809741248097412 2578 2628
10 0.9928057553956835 138 139
11 0.9997076878105817 3420 3421
12 1.0 13 13
13 1.0 140 140
14 1.0 17 17
15 0.9813311688311688 1209 1232
16 1.0 309 309
17 0.9925 397 400
18 0.9509803921568627 97 102
19 0.9665738161559888 347 359
2 0.9651860744297719 804 833
20 0.9080068143100511 2665 2935
21 0.9869848156182213 455 461
22 0.06666666666666667 2 30
23 0.9708139988724576 22386 23059
24 0.9441550678848946 11057 11711
25 0.6109510086455331 212 347
26 0.25 1 4
27 0.58 29 50
28 0.9976904176904177 60909 61050
3 0.9903846153846154 824 832
4 0.9994810586403736 1926 1927
5 0.9995196926032661 12486 12492
6 0.983729662077597 786 799
7 0.991764705882353 1686 1700
8 0.9766317485898469 2424 2482
9 0.9148936170212766 86 94
Top-1 accuracy: 0.9834399670173617
Top-3 accuracy: 0.9985722793140833
Top-5 accuracy: 0.9997785887706332
Macro-F1: 0.8974476395972021
Micro-F1: 0.9834399670173617
