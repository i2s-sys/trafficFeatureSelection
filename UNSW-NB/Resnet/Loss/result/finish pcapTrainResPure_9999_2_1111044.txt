2024-11-11 10:45:12.436039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainResPure_9999_2.py
2024-11-11 10:45:14.647008: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-11 10:45:14.655278: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-11 10:45:14.656310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-11 10:45:14.662448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-11 10:45:14.662478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-11 10:45:14.665369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-11 10:45:14.665434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-11 10:45:14.666564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-11 10:45:14.666860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-11 10:45:14.669842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-11 10:45:14.670557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-11 10:45:14.670736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-11 10:45:14.671148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-11 10:45:14.671181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-11 10:45:15.283333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-11 10:45:15.283385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-11 10:45:15.283394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-11 10:45:15.284106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13987 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
BETA = 0.9999, GAMMA = 2
init data completed!
2024-11-11 10:45:30.798143: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-11 10:45:30.799085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-11 10:45:30.799127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-11 10:45:30.799186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-11 10:45:30.799203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-11 10:45:30.799221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-11 10:45:30.799252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-11 10:45:30.799270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-11 10:45:30.799286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-11 10:45:30.799303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-11 10:45:30.799637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-11 10:45:31.753615: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-11 10:45:31.754022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-11 10:45:31.754055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-11 10:45:31.754093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-11 10:45:31.754116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-11 10:45:31.754129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-11 10:45:31.754141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-11 10:45:31.754154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-11 10:45:31.754166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-11 10:45:31.754178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-11 10:45:31.754462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-11 10:45:31.754502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-11 10:45:31.754510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-11 10:45:31.754517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-11 10:45:31.754894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13987 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
2024-11-11 10:45:33.423124: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-11 10:45:33.562461: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-11 10:45:36.424093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-11 10:45:37.131264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-11 10:45:37.153939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-11 10:45:39.391617: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-11 10:45:39.543410: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-11 10:46:17.102402: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 5.2717085627415825, duration: 220.24 seconds
Macro-F1: 0.8627709161112316
Micro-F1: 0.8640139921294272
Epoch 2 completed, average loss: 4.08645933600914, duration: 124.65 seconds
Macro-F1: 0.8759001859162155
Micro-F1: 0.8779332458825244
Epoch 3 completed, average loss: 3.9434008524311643, duration: 125.19 seconds
Macro-F1: 0.8812567422678949
Micro-F1: 0.88338677549434
Epoch 4 completed, average loss: 3.8542764522978823, duration: 125.11 seconds
Macro-F1: 0.8866298345458975
Micro-F1: 0.8892897050964388
Epoch 5 completed, average loss: 3.7709477283033337, duration: 125.55 seconds
Macro-F1: 0.8851084766319539
Micro-F1: 0.8882208618763057
Epoch 6 completed, average loss: 3.681472677484405, duration: 126.01 seconds
Macro-F1: 0.8806215501748764
Micro-F1: 0.8837875917018899
Epoch 7 completed, average loss: 3.62318263069568, duration: 126.81 seconds
Macro-F1: 0.8852952367993185
Micro-F1: 0.8880994024194724
Epoch 8 completed, average loss: 3.5715112761044, duration: 125.13 seconds
Macro-F1: 0.8823444226539581
Micro-F1: 0.8857795267939562
Epoch 9 completed, average loss: 3.533274834481707, duration: 125.04 seconds
Macro-F1: 0.8762382411995546
Micro-F1: 0.8802045377253073
Epoch 10 completed, average loss: 3.492700528541214, duration: 123.37 seconds
Macro-F1: 0.8770706743982493
Micro-F1: 0.8810183160860905
Epoch 11 completed, average loss: 3.458085965552933, duration: 122.96 seconds
Macro-F1: 0.8751276905191003
Micro-F1: 0.8792935917990575
Epoch 12 completed, average loss: 3.4170237224061966, duration: 123.81 seconds
Macro-F1: 0.8814160362991651
Micro-F1: 0.8850264781615896
Epoch 13 completed, average loss: 3.373796411723965, duration: 123.10 seconds
Macro-F1: 0.8764521630232969
Micro-F1: 0.8800587863771073
Epoch 14 completed, average loss: 3.3364827409985294, duration: 122.78 seconds
Macro-F1: 0.873932572793289
Micro-F1: 0.8778725161541079
Epoch 15 completed, average loss: 3.3146176220640986, duration: 124.02 seconds
Macro-F1: 0.8785933410113937
Micro-F1: 0.8822814944371569
Epoch 16 completed, average loss: 3.2695823885211985, duration: 126.10 seconds
Macro-F1: 0.8695533106038695
Micro-F1: 0.8742287324491085
Epoch 17 completed, average loss: 3.2169359794404926, duration: 126.97 seconds
Macro-F1: 0.8691384460843107
Micro-F1: 0.8736700189476754
Epoch 18 completed, average loss: 3.1778994412035555, duration: 126.22 seconds
Macro-F1: 0.8619693789241444
Micro-F1: 0.8670869163873101
Epoch 19 completed, average loss: 3.166219241519842, duration: 126.80 seconds
Macro-F1: 0.8645274177399498
Micro-F1: 0.8692003109362095
Epoch 20 completed, average loss: 3.088492358488441, duration: 116.43 seconds
Macro-F1: 0.8601863474876561
Micro-F1: 0.8649856677840937
loss_history [5.2717085627415825, 4.08645933600914, 3.9434008524311643, 3.8542764522978823, 3.7709477283033337, 3.681472677484405, 3.62318263069568, 3.5715112761044, 3.533274834481707, 3.492700528541214, 3.458085965552933, 3.4170237224061966, 3.373796411723965, 3.3364827409985294, 3.3146176220640986, 3.2695823885211985, 3.2169359794404926, 3.1778994412035555, 3.166219241519842, 3.088492358488441]
macro_F1List [0.8640139921294272, 0.8779332458825244, 0.88338677549434, 0.8892897050964388, 0.8882208618763057, 0.8837875917018899, 0.8880994024194724, 0.8857795267939562, 0.8802045377253073, 0.8810183160860905, 0.8792935917990575, 0.8850264781615896, 0.8800587863771073, 0.8778725161541079, 0.8822814944371569, 0.8742287324491085, 0.8736700189476754, 0.8670869163873101, 0.8692003109362095, 0.8649856677840937]
micro_F1List [0.8627709161112316, 0.8759001859162155, 0.8812567422678949, 0.8866298345458975, 0.8851084766319539, 0.8806215501748764, 0.8852952367993185, 0.8823444226539581, 0.8762382411995546, 0.8770706743982493, 0.8751276905191003, 0.8814160362991651, 0.8764521630232969, 0.873932572793289, 0.8785933410113937, 0.8695533106038695, 0.8691384460843107, 0.8619693789241444, 0.8645274177399498, 0.8601863474876561]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
0 0.7562432432432432 27981 37000
1 0.9537412865084267 43235 45332
Top-1 accuracy: 0.8649856677840937
Top-3 accuracy: 1.0
Top-5 accuracy: 1.0
Macro-F1: 0.8601863474876561
Micro-F1: 0.8649856677840937
