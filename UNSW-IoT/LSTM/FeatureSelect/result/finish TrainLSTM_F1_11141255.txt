2024-11-14 12:58:14.426563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: TrainLSTM_F1.py
2024-11-14 12:58:15.862862: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-14 12:58:15.869793: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-14 12:58:15.870809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-14 12:58:15.890309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-14 12:58:15.890345: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-14 12:58:15.893131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-14 12:58:15.893192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-14 12:58:15.894288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-14 12:58:15.894560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-14 12:58:15.897567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-14 12:58:15.898257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-14 12:58:15.898425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-14 12:58:15.898798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-14 12:58:15.898828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-14 12:58:16.488428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-14 12:58:16.488525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-14 12:58:16.488533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-14 12:58:16.489578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22259 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
BETA = 0.999, GAMMA = 2
init data completed!
2024-11-14 12:58:58.657857: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-14 12:58:58.658640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-14 12:58:58.658676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-14 12:58:58.658738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-14 12:58:58.658757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-14 12:58:58.658776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-14 12:58:58.658805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-14 12:58:58.658823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-14 12:58:58.658841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-14 12:58:58.658858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-14 12:58:58.659182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-14 12:58:58.659397: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-14 12:58:58.659625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-14 12:58:58.659647: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-14 12:58:58.659679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-14 12:58:58.659693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-14 12:58:58.659707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-14 12:58:58.659721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-14 12:58:58.659735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-14 12:58:58.659749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-14 12:58:58.659763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-14 12:58:58.660032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-14 12:58:58.660077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-14 12:58:58.660086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-14 12:58:58.660093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-14 12:58:58.660420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22259 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
WARNING:tensorflow:Layer lstm will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
2024-11-14 12:58:58.805808: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-14 12:58:58.806079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-14 12:58:58.806103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-14 12:58:58.806128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-14 12:58:58.806140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-14 12:58:58.806162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-14 12:58:58.806174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-14 12:58:58.806186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-14 12:58:58.806198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-14 12:58:58.806210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-14 12:58:58.806492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-14 12:58:58.806517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-14 12:58:58.806526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-14 12:58:58.806532: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-14 12:58:58.806829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22259 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
2024-11-14 12:58:59.032134: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-14 12:58:59.051320: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-14 12:58:59.292278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-14 12:58:59.930689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-14 12:58:59.938020: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Macro-F1: 0.24560245555398585
Micro-F1: 0.8163050283253677
Epoch 1 completed, average loss: 15.352503007857631, duration: 1847.20 seconds
Macro-F1: 0.3511858445022911
Micro-F1: 0.8476232649757974
Epoch 2 completed, average loss: 8.904187001790469, duration: 1824.45 seconds
Macro-F1: 0.4385150655451893
Micro-F1: 0.8626639588327811
Epoch 3 completed, average loss: 7.197397961994071, duration: 1824.82 seconds
Macro-F1: 0.4644779841558633
Micro-F1: 0.876002076684634
Epoch 4 completed, average loss: 6.13732119005097, duration: 1909.27 seconds
Epoch 4, Intersection size: 0
Macro-F1: 0.5001207685567715
Micro-F1: 0.8851562857884531
Epoch 5 completed, average loss: 5.368426088264012, duration: 1919.47 seconds
Epoch 5, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.5633046839020263
Micro-F1: 0.8932339782253508
Epoch 6 completed, average loss: 4.789772119090604, duration: 1831.87 seconds
Epoch 6, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.5910174891390033
Micro-F1: 0.8953870115591932
Epoch 7 completed, average loss: 4.337923021934799, duration: 1851.11 seconds
Epoch 7, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.6077616600090336
Micro-F1: 0.8989295912290614
Epoch 8 completed, average loss: 3.9584432309473914, duration: 1808.73 seconds
Epoch 8, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.6068647667044013
Micro-F1: 0.8989601307089741
Epoch 9 completed, average loss: 3.662874561026349, duration: 1866.68 seconds
Epoch 9, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.6224965749666732
Micro-F1: 0.8999602986761135
Epoch 10 completed, average loss: 3.424762831280608, duration: 1687.92 seconds
Epoch 10, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.6506110816106841
Micro-F1: 0.9034188947762218
Epoch 11 completed, average loss: 3.219227337917125, duration: 1881.19 seconds
Epoch 11, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.6611271763287403
Micro-F1: 0.9071141718456535
Epoch 12 completed, average loss: 3.033668606836625, duration: 1862.45 seconds
Epoch 12, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.6604164198063506
Micro-F1: 0.9105269587258928
Epoch 13 completed, average loss: 2.874559052928402, duration: 1872.02 seconds
Epoch 13, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.6611244356662453
Micro-F1: 0.9139855548260013
Epoch 14 completed, average loss: 2.7450571966985304, duration: 1881.17 seconds
Epoch 14, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.66223746761893
Micro-F1: 0.9159171769304769
Epoch 15 completed, average loss: 2.633527522212949, duration: 1812.80 seconds
Epoch 15, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.6715867256655126
Micro-F1: 0.920337766647834
Epoch 16 completed, average loss: 2.536195312227522, duration: 1747.33 seconds
Epoch 16, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.7058370903142033
Micro-F1: 0.9249644978546016
Epoch 17 completed, average loss: 2.4420869652701565, duration: 1849.97 seconds
Epoch 17, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.6913430705940992
Micro-F1: 0.9229336224404099
Epoch 18 completed, average loss: 2.342944412274894, duration: 1844.20 seconds
Epoch 18, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.7203870072565589
Micro-F1: 0.9249950373345142
Epoch 19 completed, average loss: 2.3115781423533166, duration: 1888.76 seconds
Epoch 19, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.703723286906105
Micro-F1: 0.9226893066011086
Epoch 20 completed, average loss: 2.2047361080797336, duration: 1874.57 seconds
Epoch 20, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.7474088896136446
Micro-F1: 0.9325459237429187
Epoch 21 completed, average loss: 2.1179292756466372, duration: 1850.09 seconds
Epoch 21, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.7297397503022393
Micro-F1: 0.9305761272885523
Epoch 22 completed, average loss: 2.0660480264969134, duration: 1671.13 seconds
Epoch 22, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.7535386887153898
Micro-F1: 0.9351570492754508
Epoch 23 completed, average loss: 2.0845838171770548, duration: 1881.99 seconds
Epoch 23, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.7394280052576648
Micro-F1: 0.9284536334346227
Epoch 24 completed, average loss: 2.2259842206555827, duration: 1894.31 seconds
Epoch 24, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.753425888835046
Micro-F1: 0.938088839347066
Epoch 25 completed, average loss: 1.920824460120295, duration: 1782.18 seconds
Epoch 25, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.7465300834299522
Micro-F1: 0.9371802898196644
Epoch 26 completed, average loss: 1.9094921488316428, duration: 1882.51 seconds
Epoch 26, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.7719226773186689
Micro-F1: 0.9422880178350562
Epoch 27 completed, average loss: 1.799100718615092, duration: 1877.85 seconds
Epoch 27, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.7699800575744169
Micro-F1: 0.9427919192536152
Epoch 28 completed, average loss: 1.833797312876546, duration: 1733.97 seconds
Epoch 28, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.7784860116635566
Micro-F1: 0.9442807188993572
Epoch 29 completed, average loss: 1.6935021039777387, duration: 1886.54 seconds
Epoch 29, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
Macro-F1: 0.7867071382039089
Micro-F1: 0.9465788147627846
Epoch 30 completed, average loss: 1.6843689182811468, duration: 1896.07 seconds
Epoch 30, Intersection size: 1
Early stopping condition met.
model.earlyStop == True 看top K factor
K= 1 top_k_indices [55]
TSMRecord—100 [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
loss_history—100 [15.352503007857631, 8.904187001790469, 7.197397961994071, 6.13732119005097, 5.368426088264012, 4.789772119090604, 4.337923021934799, 3.9584432309473914, 3.662874561026349, 3.424762831280608, 3.219227337917125, 3.033668606836625, 2.874559052928402, 2.7450571966985304, 2.633527522212949, 2.536195312227522, 2.4420869652701565, 2.342944412274894, 2.3115781423533166, 2.2047361080797336, 2.1179292756466372, 2.0660480264969134, 2.0845838171770548, 2.2259842206555827, 1.920824460120295, 1.9094921488316428, 1.799100718615092, 1.833797312876546, 1.6935021039777387, 1.6843689182811468]
Total training time: 55244.09 seconds
scaling_factor_value： [[1.1047161e+00 2.7428302e-06 9.2640918e-01 9.5792276e-01 1.0502660e+00
  2.9418045e-01 8.9833933e-01 9.3695194e-01 8.6900443e-01 8.8106674e-01
  2.6830163e-02 4.8676553e-01 8.1500918e-01 1.3737770e+00 1.3508381e+00
  1.4477595e+00 1.1313186e+00 9.2944384e-01 1.1379031e+00 1.2648351e+00
  1.3734821e+00 8.2562262e-01 7.4267608e-01 6.7843181e-01 7.9745853e-01
  6.4847052e-01 1.4472476e+00 1.2521120e+00 8.7183750e-01 8.8358361e-01
  8.5366452e-01 1.2873833e+00 8.4366298e-01 7.4343878e-01 7.9140824e-01
  1.2695180e+00 1.2876517e+00 8.6780596e-01 9.4908780e-01 6.1850333e-01
  1.0449569e+00 1.0562731e+00 1.1248767e+00 9.9807543e-01 8.3788234e-01
  9.7806561e-01 8.9624310e-01 8.0977887e-01 9.4696856e-01 1.1518445e+00
  1.1833905e+00 3.8559967e-01 1.5436447e+00 1.0739343e+00 2.1742916e+00
  3.2159753e+00 1.4331329e+00 8.9943653e-01 9.3745905e-01 1.6448414e-05
  1.1374894e+00 1.1884037e+00 2.1011381e+00 1.6448414e-05 7.0066839e-01
  1.6448414e-05 1.0664191e+00 1.1186819e+00 1.0757205e+00 1.3992342e+00
  1.9076968e+00 1.7559972e+00]]
start testing...
sorted_indices： [55 54 62 70 71 52 15 26 56 69 13 20 14 36 31 35 19 27 61 50 49 18 60 16
 42 67  0 68 53 66 41  4 40 43 45  3 38 48 58  7 17  2 57  6 46 29  9 28
  8 37 30 32 44 21 12 47 24 34 33 22 64 23 25 39 11 51  5 10 65 63 59  1]
Macro-F1: 0.7867071382039089
Micro-F1: 0.9465788147627846
loss_history [15.352503007857631, 8.904187001790469, 7.197397961994071, 6.13732119005097, 5.368426088264012, 4.789772119090604, 4.337923021934799, 3.9584432309473914, 3.662874561026349, 3.424762831280608, 3.219227337917125, 3.033668606836625, 2.874559052928402, 2.7450571966985304, 2.633527522212949, 2.536195312227522, 2.4420869652701565, 2.342944412274894, 2.3115781423533166, 2.2047361080797336, 2.1179292756466372, 2.0660480264969134, 2.0845838171770548, 2.2259842206555827, 1.920824460120295, 1.9094921488316428, 1.799100718615092, 1.833797312876546, 1.6935021039777387, 1.6843689182811468]
macro_F1List [0.24560245555398585, 0.3511858445022911, 0.4385150655451893, 0.4644779841558633, 0.5001207685567715, 0.5633046839020263, 0.5910174891390033, 0.6077616600090336, 0.6068647667044013, 0.6224965749666732, 0.6506110816106841, 0.6611271763287403, 0.6604164198063506, 0.6611244356662453, 0.66223746761893, 0.6715867256655126, 0.7058370903142033, 0.6913430705940992, 0.7203870072565589, 0.703723286906105, 0.7474088896136446, 0.7297397503022393, 0.7535386887153898, 0.7394280052576648, 0.753425888835046, 0.7465300834299522, 0.7719226773186689, 0.7699800575744169, 0.7784860116635566, 0.7867071382039089]
micro_F1List [0.8163050283253677, 0.8476232649757974, 0.8626639588327811, 0.876002076684634, 0.8851562857884531, 0.8932339782253508, 0.8953870115591932, 0.8989295912290614, 0.8989601307089741, 0.8999602986761135, 0.9034188947762218, 0.9071141718456535, 0.9105269587258928, 0.9139855548260013, 0.9159171769304769, 0.920337766647834, 0.9249644978546016, 0.9229336224404099, 0.9249950373345142, 0.9226893066011086, 0.9325459237429187, 0.9305761272885523, 0.9351570492754508, 0.9284536334346227, 0.938088839347066, 0.9371802898196644, 0.9422880178350562, 0.9427919192536152, 0.9442807188993572, 0.9465788147627846]
starting retraining
K= 1 top_k_indices [55]
BETA = 0.999, GAMMA = 2
init data completed!
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
2024-11-15 04:48:45.092645: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-15 04:48:45.093073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-15 04:48:45.093104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-15 04:48:45.093171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-15 04:48:45.093188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-15 04:48:45.093205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-15 04:48:45.093221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-15 04:48:45.093237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-15 04:48:45.093254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-15 04:48:45.093269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-15 04:48:45.093577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-15 04:48:45.093615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-15 04:48:45.093625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-15 04:48:45.093633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-15 04:48:45.093968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22259 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
start retraining...
Macro-F1: 0.022019234774874434
Micro-F1: 0.4661011772969506
Epoch 1 completed, average loss: 35.17271984597355, duration: 244.93 seconds
Macro-F1: 0.02629563735355066
Micro-F1: 0.4677503092122341
Epoch 2 completed, average loss: 24.353680573500597, duration: 243.63 seconds
Macro-F1: 0.0420383689669672
Micro-F1: 0.48728030661637833
Epoch 3 completed, average loss: 23.353675379631255, duration: 254.74 seconds
Macro-F1: 0.041939167430133255
Micro-F1: 0.4892730076806792
Epoch 4 completed, average loss: 22.680873767771278, duration: 256.09 seconds
Macro-F1: 0.058915964300514025
Micro-F1: 0.4922506069721633
Epoch 5 completed, average loss: 22.251836022823287, duration: 300.62 seconds
Macro-F1: 0.05887236115733684
Micro-F1: 0.4922506069721633
Epoch 6 completed, average loss: 21.95580712051935, duration: 299.37 seconds
Macro-F1: 0.05892296271238391
Micro-F1: 0.4922658767121196
Epoch 7 completed, average loss: 21.724106709928158, duration: 299.21 seconds
Macro-F1: 0.058147709461585005
Micro-F1: 0.4918994029531677
Epoch 8 completed, average loss: 21.524523017093834, duration: 297.70 seconds
Macro-F1: 0.058147709461585005
Micro-F1: 0.4918994029531677
Epoch 9 completed, average loss: 21.34106072272823, duration: 302.98 seconds
Macro-F1: 0.058147709461585005
Micro-F1: 0.4918994029531677
Epoch 10 completed, average loss: 21.16477895352348, duration: 279.59 seconds
Macro-F1: 0.058147709461585005
Micro-F1: 0.4918994029531677
Epoch 11 completed, average loss: 20.988758347650727, duration: 286.46 seconds
Macro-F1: 0.05822906727294977
Micro-F1: 0.49193757730305854
Epoch 12 completed, average loss: 20.811598825714405, duration: 292.89 seconds
Macro-F1: 0.04418674172986552
Micro-F1: 0.49191467269312406
Epoch 13 completed, average loss: 20.666366122884636, duration: 290.67 seconds
Macro-F1: 0.044385138442087885
Micro-F1: 0.4919681167829712
Epoch 14 completed, average loss: 20.557155556792637, duration: 288.20 seconds
Macro-F1: 0.04438568140490569
Micro-F1: 0.4919681167829712
Epoch 15 completed, average loss: 20.469852857425916, duration: 284.25 seconds
Macro-F1: 0.0441554754016135
Micro-F1: 0.4920597352227092
Epoch 16 completed, average loss: 20.399107668556624, duration: 296.36 seconds
Macro-F1: 0.04432639410615425
Micro-F1: 0.4920750049626655
Epoch 17 completed, average loss: 20.340995864884146, duration: 288.36 seconds
Macro-F1: 0.04539664117932354
Micro-F1: 0.49192994243308036
Epoch 18 completed, average loss: 20.292515295242033, duration: 291.38 seconds
Macro-F1: 0.04539664117932354
Micro-F1: 0.49192994243308036
Epoch 19 completed, average loss: 20.25152507984943, duration: 288.55 seconds
Macro-F1: 0.04556705753163175
Micro-F1: 0.4919452121730367
Epoch 20 completed, average loss: 20.216436231490903, duration: 294.57 seconds
Macro-F1: 0.04556705753163175
Micro-F1: 0.4919452121730367
Epoch 21 completed, average loss: 20.186060198291255, duration: 292.12 seconds
Macro-F1: 0.04747745148806011
Micro-F1: 0.49144131075447783
Epoch 22 completed, average loss: 20.159522758950537, duration: 292.70 seconds
Macro-F1: 0.04747745148806011
Micro-F1: 0.49144131075447783
Epoch 23 completed, average loss: 20.13611829515576, duration: 287.02 seconds
Macro-F1: 0.04745355201970265
Micro-F1: 0.49150238971430316
Epoch 24 completed, average loss: 20.115300865716698, duration: 291.54 seconds
Macro-F1: 0.047454870522226196
Micro-F1: 0.49150238971430316
Epoch 25 completed, average loss: 20.096677597167353, duration: 287.96 seconds
Macro-F1: 0.049159153771777764
Micro-F1: 0.4915481989341722
Epoch 26 completed, average loss: 20.080007409669886, duration: 293.86 seconds
Macro-F1: 0.049159153771777764
Micro-F1: 0.4915481989341722
Epoch 27 completed, average loss: 20.064932185933337, duration: 290.76 seconds
Macro-F1: 0.049159153771777764
Micro-F1: 0.4915481989341722
Epoch 28 completed, average loss: 20.051210219259787, duration: 296.40 seconds
Macro-F1: 0.04916077122645913
Micro-F1: 0.4915481989341722
Epoch 29 completed, average loss: 20.03862073064899, duration: 279.56 seconds
Macro-F1: 0.04916077122645913
Micro-F1: 0.4915481989341722
Epoch 30 completed, average loss: 20.0269919236834, duration: 291.67 seconds
dnn2_loss_history [35.17271984597355, 24.353680573500597, 23.353675379631255, 22.680873767771278, 22.251836022823287, 21.95580712051935, 21.724106709928158, 21.524523017093834, 21.34106072272823, 21.16477895352348, 20.988758347650727, 20.811598825714405, 20.666366122884636, 20.557155556792637, 20.469852857425916, 20.399107668556624, 20.340995864884146, 20.292515295242033, 20.25152507984943, 20.216436231490903, 20.186060198291255, 20.159522758950537, 20.13611829515576, 20.115300865716698, 20.096677597167353, 20.080007409669886, 20.064932185933337, 20.051210219259787, 20.03862073064899, 20.0269919236834]
dnn2_macro_F1List [0.022019234774874434, 0.02629563735355066, 0.0420383689669672, 0.041939167430133255, 0.058915964300514025, 0.05887236115733684, 0.05892296271238391, 0.058147709461585005, 0.058147709461585005, 0.058147709461585005, 0.058147709461585005, 0.05822906727294977, 0.04418674172986552, 0.044385138442087885, 0.04438568140490569, 0.0441554754016135, 0.04432639410615425, 0.04539664117932354, 0.04539664117932354, 0.04556705753163175, 0.04556705753163175, 0.04747745148806011, 0.04747745148806011, 0.04745355201970265, 0.047454870522226196, 0.049159153771777764, 0.049159153771777764, 0.049159153771777764, 0.04916077122645913, 0.04916077122645913]
dnn2_micro_F1List [0.4661011772969506, 0.4677503092122341, 0.48728030661637833, 0.4892730076806792, 0.4922506069721633, 0.4922506069721633, 0.4922658767121196, 0.4918994029531677, 0.4918994029531677, 0.4918994029531677, 0.4918994029531677, 0.49193757730305854, 0.49191467269312406, 0.4919681167829712, 0.4919681167829712, 0.4920597352227092, 0.4920750049626655, 0.49192994243308036, 0.49192994243308036, 0.4919452121730367, 0.4919452121730367, 0.49144131075447783, 0.49144131075447783, 0.49150238971430316, 0.49150238971430316, 0.4915481989341722, 0.4915481989341722, 0.4915481989341722, 0.4915481989341722, 0.4915481989341722]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
Processed 90000 rows
Processed 100000 rows
Processed 110000 rows
Processed 120000 rows
Processed 130000 rows
0 0.0 0 1412
1 0.0 0 2628
10 0.0 0 139
11 0.9277988892136803 3174 3421
12 0.0 0 13
13 0.0 0 140
14 0.0 0 17
15 0.0 0 1232
16 0.0 0 309
17 0.0 0 400
18 0.0 0 102
19 0.0 0 359
2 0.0 0 833
20 0.0 0 2935
21 0.0 0 461
22 0.0 0 30
23 0.0 0 23059
24 0.03560754845871403 417 11711
25 0.0 0 347
26 0.0 0 4
27 0.0 0 50
28 0.9933660933660934 60645 61050
3 0.0 0 832
4 0.03476907109496627 67 1927
5 0.0 0 12492
6 0.012515644555694618 10 799
7 0.0 0 1700
8 0.027800161160354553 69 2482
9 0.0 0 94
Top-1 accuracy: 0.4915481989341722
Top-3 accuracy: 0.8105559712318099
Top-5 accuracy: 0.9180244010444503
